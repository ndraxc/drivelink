<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Drive Flix - Movieku</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
    :root {
      /* DEFAULT = DARK THEME */
      --bg: #000000;
      --bg-soft: #2222354a;
      --accent: #575757;
      --accent-red: #e81d27; /* Netflix Red vibe */
      --accent-soft: #0a0b14;
      --text: #e3e3e3;
      --text-white: #ffffff;
      --muted: #bdbbbb;
      --border: #901f1fb5; 
      /* New Soft Border Variables */
      --glow-color: rgba(0, 0, 0, 0.46);
      --border-light: rgba(0, 0, 0, 0.453);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-pill: 9px; 
      --radius-btn: 12px; 
      --card-bg: #202020;
      --chip-bg: #1d1d21;
      --overlay-grad: linear-gradient(to top, #000000aa, #e0000000);
      --shadow-strong: 0 10px 30px rgba(0,0,0,0.5);
      --pill-dark-bg: rgba(15,23,42,0.8);
      --pill-dark-border: rgba(148,163,184,0.4);
      --pill-dark-text: #e5e7eb;
    }

    body.theme-dark .card {
      background: #2a2a2a85 !important;
    }

    /* LIGHT THEME OVERRIDE */
    body.theme-light {
      --bg: #e3e3e3;
      --bg-soft: #f0f0f0;
      --accent: #444444;
      --accent-red: #ff2d55;
      --accent-soft: rgba(71, 71, 71, 0.1);
      --text: #111827cb;
      --text-white: #111827;
      --muted: #555555;
      --border: #e5e7eb;
      --glow-color: rgba(0, 0, 0, 0.05);
      --border-light: rgba(0, 0, 0, 0.08);
      --card-bg: #ffffff;
      --chip-bg: #f3f4f6;
      --overlay-grad: linear-gradient(to top, #00000066, #00000000);
      --shadow-strong: 0 10px 25px rgba(15, 23, 42, 0.15);
    }

    body.theme-light {
      --text: #111111 !important;
      --text-white: #000000 !important; 
      --muted: #323232 !important;
    }
@media (max-width: 480px) {
  .search-clear-btn {
   margin-left: -12px;   /* geser dikit dari tepi kanan */
    /* kalau masih kurang, coba 8px / 10px */
  }
}

    #clockColon {
      display: inline-block;
      transition: opacity 0.15s ease;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    .meta-value.clickable {
      text-decoration: none !important;
      border-bottom: none !important;
    }

    .pill-dot {
      display: none;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #271e3b, var(--bg) 55%);
      color: var(--text);
      min-height: 100vh;
      transition: background 0.25s ease, color 0.25s ease;
      position: relative;
      overflow-x: hidden;
    }

    body.theme-light {
      background: radial-gradient(circle at top, #e5e7ff, var(--bg) 55%);
    }

    .page {
      max-width: 1300px;
      margin: 0 auto;
      padding: 20px 16px 40px;
      position: relative;
      z-index: 1;
    }

    /* =======================
        SPACE BACKGROUND LAYER
        ======================= */
    .space-bg {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      background: transparent;
      overflow: hidden;
    }

    .space-star {
      position: absolute;
      width: 3px;
      height: 3px;
      border-radius: 50%;
      background: #ffffff;
      box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
      opacity: 0.8;
      animation: starTwinkle 2.4s ease-in-out infinite alternate;
    }

    .space-star.star-1 { top: 10%; left: 14%; }
    .space-star.star-2 { top: 18%; right: 12%; }
    .space-star.star-3 { top: 28%; left: 45%; }
    .space-star.star-4 { top: 40%; left: 8%; }
    .space-star.star-5 { top: 55%; right: 20%; }
    .space-star.star-6 { bottom: 28%; left: 26%; }
    .space-star.star-7 { bottom: 18%; right: 14%; }
    .space-star.star-8 { bottom: 12%; left: 12%; }

    @keyframes starTwinkle {
      0%    { opacity: 0.2; transform: scale(0.9); }
      50%   { opacity: 0.9; transform: scale(1.2); }
      100% { opacity: 0.4; transform: scale(1.0); }
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 18px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: conic-gradient(from 210deg, #ff4b8b, #ffc857, #7f5dff, #ff4b8b);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 18px;
      color: #05050a;
      box-shadow: 0 0 20px #ff4b8b55;
    }

    .brand-text-title {
      font-weight: 700;
      letter-spacing: 0.03em;
      font-size: 18px;
    }

    .brand-text-sub {
      font-size: 12px;
      color: var(--muted);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pill-badge {
      border-radius: var(--radius-pill);
      padding: 6px 16px;
      font-size: 11px;
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 0 8px var(--glow-color);
      background: #00000021;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      backdrop-filter: blur(8px);
    }

    body.theme-light .pill-badge {
      background: rgba(255, 255, 255, 0.8);
      color: var(--muted);
    }

    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #34d399;
      box-shadow: 0 0 8px #34d399aa;
    }

    #modeLabel {
      display: none;
    }

    .theme-toggle, .header-small-btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 2px 5px rgba(0,0,0,0.1);
      background: var(--card-bg);
      color: var(--text);
      font-size: 11px;
      padding: 6px 10px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: 0.2s ease;
    }

    .theme-toggle:hover, .header-small-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent-soft), 0 4px 12px rgba(0,0,0,0.25);
    }

    .header-small-btn.active {
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
      color: var(--text);
    }

    body.theme-light .header-small-btn.active {
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
    }

    /* =========================================
        HERO CAROUSEL SECTION
        ========================================= */
    .hero-section {
      position: relative;
      width: 100%;
      height: 400px;
      border-radius: 24px;
      overflow: hidden;
      margin-bottom: 30px;
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 
                  0 20px 50px -10px rgba(0,0,0,0.5), 
                  0 0 20px var(--glow-color) inset;
      opacity: 1;
      transition:
        height 0.35s ease,
        opacity 0.25s ease,
        margin-bottom 0.35s ease;
      touch-action: pan-y; /* biar swipe horizontal lebih halus */
    }

    .hero-section.is-hidden {
      height: 0;
      opacity: 0;
      margin-bottom: 0;
      pointer-events: none;
    }

.hero-slide {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  /* Default: Standby di KANAN (100%) */
  transform: translateX(100%);
  opacity: 0;
  transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.6s ease;
  z-index: 1;
  pointer-events: none;
}
/* ğŸ”¥ helper class arah slide */
.hero-slide.left {
  transform: translateX(-100%);
  opacity: 0;
}

.hero-slide.right {
  transform: translateX(100%);
  opacity: 0;
}

    /* ğŸ’¡ Tambahkan transisi cepat untuk perpindahan instan (saat loop) */
    .hero-slide.no-transition {
        transition: none !important;
    }

   /* Slide Aktif (Di Tengah) */
.hero-slide.active {
  transform: translateX(0);
  opacity: 1;
  z-index: 2;
  pointer-events: auto;
}
    .hero-slide.prev {
      transform: translateX(-100%);
      opacity: 0;
      z-index: 1;
    }
/* Slide yang Keluar ke KIRI */
.hero-slide.exit-left {
  transform: translateX(-100%);
  opacity: 0;
  z-index: 1;
}

/* Helper: Paksa slide standby di KIRI dulu (untuk tombol Prev) */
.hero-slide.from-left {
  transform: translateX(-100%) !important;
  opacity: 0;
  transition: none !important; /* Matikan animasi saat teleport */
}

/* Helper: Paksa slide standby di KANAN dulu (untuk tombol Next / Loop) */
.hero-slide.from-right {
  transform: translateX(100%) !important;
  opacity: 0;
  transition: none !important;
}
    /* ğŸ”¥ Tambahan: Posisi untuk slide yang datang dari kiri (saat swipe prev) */
    .hero-slide.coming-from-left {
        transform: translateX(-100%);
        opacity: 0;
        z-index: 1;
    }
    
    /* ğŸ”¥ Tambahan: Posisi untuk slide yang datang dari kanan (saat swipe next) */
    .hero-slide.coming-from-right {
        transform: translateX(100%);
        opacity: 0;
        z-index: 1;
    }

    .hero-bg-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .hero-overlay-gradient {
      position: absolute;
      inset: 0;
      background: linear-gradient(to right, #000000cc 0%, #00000088 40%, transparent 100%),
                  linear-gradient(to top, #05050a 0%, transparent 50%);
      z-index: 1;
    }
    
    body.theme-light .hero-overlay-gradient {
      background: linear-gradient(to right, #00000053 0%, #0000001e 40%, transparent 100%),
                  linear-gradient(to top, #0000003c 0%, transparent 50%);
    }

    @media (max-width: 400px) {
      .download-btn,
      #playerPlaylistMainBtn {
        padding: 8px;
        border-radius: 8px;
      }

      .download-btn svg,
      #playerPlaylistMainBtn svg {
        width: 18px;
        height: 18px;
      }
    }

    .hero-content {
      position: absolute;
      top: 50%;
      left: 40px;
      transform: translateY(-50%);
      z-index: 3;
      max-width: 500px;
      color: var(--text-white);
      text-align: left;
    }
    
    body.theme-light .hero-content {
      color: #000;
    }

    .hero-meta {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 11px; 
      font-weight: 600;
      color: #ffc857;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      text-shadow: 0 0 10px rgba(255, 200, 87, 0.3);
    }

    .hero-title {
      font-size: 32px; 
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 12px;
      text-shadow: 0 2px 10px rgba(0,0,0,0.5);
    }

    .hero-desc {
      font-size: 12px; 
      line-height: 1.6;
      color: #d1d5db;
      margin-bottom: 24px;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-shadow: 0 1px 4px rgba(0,0,0,0.8);
    }

    .hero-actions {
      display: flex;
      gap: 14px;
    }

    @media (max-width: 480px) {
      .hero-actions {
        gap: 11px;
      }
    }

    @media (max-width: 480px) {
      .download-btn,
      .playlist-btn {
        font-size: 10px !important;
      }
    }

    @media (max-width: 480px) {
      .player-title {
        font-size: 14px!important;
      }
    }

    .hero-btn {
      padding: 8px 20px;
      border-radius: var(--radius-btn);
      font-size: 11.5px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 7px;
      transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
      border: none;
    }

    .hero-btn-primary {
      background: var(--accent-red);
      color: #fff;
      box-shadow: 0 4px 15px rgba(229, 9, 20, 0.4), 0 0 0 1px rgba(229, 9, 20, 0.2) inset;
    }

    .hero-btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(229, 9, 20, 0.6), 0 0 0 1px rgba(229, 9, 20, 0.4) inset;
    }

    .hero-btn-pink-outline {
      background: transparent;
      color: #d5d5d5;    
      border: 1px solid #d5d5d5d0; 
      box-shadow: 0 0 10px var(--accent-soft);
      backdrop-filter: blur(4px);
      border-radius: var(--radius-btn);
    }

    .hero-btn-pink-outline:hover {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 0 20px var(--accent);
      transform: translateY(-2px);
    }

  /* ===== HERO DOT STRIP BAR ===== */
.hero-indicators {
  position: absolute;
  bottom: 16px;
  right: 18px;

  display: flex;
  align-items: center;
  gap: 8px;

  padding: 4px 10px;
  border-radius: 999px;

  /* ğŸ”¥ Bar hitam elegan tanpa terlalu tebal
     bisa kamu turunin opacity kalau mau makin transparan */
  background: rgba(0, 0, 0, 0.45);

  /* Glow lembut ke bawah biar lebih cinematic */
  box-shadow: 0 0 18px rgba(0, 0, 0, 0.7);

  z-index: 5;
}

/* ===== Dot Default ===== */
.hero-dot {
  width: 7px;
  height: 7px;
  border-radius: 999px;
  background: #6b7280;
  opacity: 0.9;
  cursor: pointer;

  transition:
    width 0.22s ease-out,
    background 0.22s ease-out,
    opacity 0.22s ease-out,
    box-shadow 0.22s ease-out;
}
@media (max-width: 480px) {

  /* JAM */
  .time-row {
    display: flex !important;
    width: 100% !important;
  }
  .time-row > * {
    margin-left: auto !important;
  }

  /* URUTKAN */
  .sort-row {
    display: flex !important;
    width: 100% !important;
    justify-content: flex-end !important;
    align-items: center !important;
  }
  .sort-row > * {
    margin-left: auto !important;
  }

}

/* ===== Dot Aktif (Netflix-style Red Pill) ===== */
.hero-dot.active {
  width: 20px;
  background: linear-gradient(135deg, #ef4444, #dc2626);
  opacity: 1;

  /* Glow merah lembut */
  box-shadow: 0 0 14px rgba(239, 68, 68, 0.8),
              0 0 4px rgba(239, 68, 68, 0.6);
}
.hero-indicators {
  background: rgba(0, 0, 0, 0);   /* SUPER TIPIS */
  box-shadow: 0 0 6px rgba(0, 0, 0, 0);
}
.card .thumb-wrapper {
  aspect-ratio: 16 / 9;
}

.card .card-main {
  padding: 1px 8px;
}
.grid-separator {
  display: none !important;
}
@media (max-width: 383px) {
  /* ğŸ”¥ Sembunyikan chip yang mengandung text "Artis:" atau "Label:" */
  .filter-chip:has(span),
  .filter-chip:has(*) {
    /* fallback untuk selector text */
  }

  /* Cara pasti: pakai attribute selector contains */
  .filter-chip[data-type="artist"],
  .filter-chip[data-type="label"] {
    display: none !important;
  }
}
/* ğŸ”¥ SEMUA PERUBAHAN INI AKTIF DI LAYAR < 383px */
@media (max-width: 383px) {

  /* --- 1. SEMBUNYIKAN JAM --- */
  .header-time-row,
  .time-row,
  .time-pill,
  .time-chip {
    display: none !important;
  }

  /* --- 2. SEMBUNYIKAN URUTKAN --- */
  .sort-row,
  .sort-container,
  .sort-wrapper,
  .sort-label,
  .sort-trigger {
    display: none !important;
  }



}
@media (max-width: 383px) {
  .filter-chip:has(:where(*:contains("Artis:"), *:contains("Label:"))) {
    display: none !important;
  }
}

    
    body.theme-light .hero-dot {
      background: rgba(255,255,255,0.3); 
    }

    body.theme-light .hero-dot.active {
      background: var(--accent);
    }

    .hero-dot.active {
      background: var(--accent-red);
      box-shadow: 0 0 8px var(--accent-red);
    }

    @media (max-width: 768px) {
      .theme-toggle,
      .header-small-btn,
      .pill-badge {
        padding: 4px 8px;
        font-size: 10px;
      }

      .brand-text-title {
        font-size: 16px;
      }

      .brand-text-sub {
        font-size: 11px;
      }
    }

    body.theme-light .hero-desc {
      color: #374151;
      text-shadow:
        0 0 8px rgba(0,0,0,0.40),
        0 2px 6px rgba(0,0,0,0.30);
      font-weight: 500;
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-bottom: 20px;
    }

    .top-controls-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .search-box {
      flex: 1;
      min-width: 200px;
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: var(--radius-lg);
      background: var(--card-bg);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 2px 8px rgba(0,0,0,0.05);
      transition: 0.2s ease;
    }
    .search-clear-btn {
  border: none;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  font-size: 14px;
  padding: 2px 4px;
  display: none;            /* default disembunyikan */
  align-items: center;
  justify-content: center;
}

.search-clear-btn:hover {
  color: var(--text);
}


    .search-box:focus-within {
      box-shadow: 0 0 0 1px var(--accent), 0 0 12px var(--accent-soft);
    }

    .search-box input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: var(--text);
      font-size: 12px;
    }

    .search-box input::placeholder {
      color: var(--muted);
    }

    .search-icon {
      font-size: 14px;
      opacity: 0.8;
    }

    .sort-wrapper {
      position: relative;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 2px 5px rgba(0,0,0,0.05);
      background: var(--card-bg);
      font-size: 12px;
      color: var(--muted);
    }

    .sort-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      opacity: 0.9;
    }

    .sort-trigger {
      border: none;
      background: transparent;
      color: var(--text);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .sort-trigger-icon {
      font-size: 10px;
      opacity: 0.9;
      transform: translateY(1px);
    }

    .sort-menu {
      position: absolute;
      top: 110%;
      right: 8px;
      min-width: 150px;
      background: var(--card-bg);
      border-radius: 12px;
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 14px 40px rgba(0,0,0,0.4);
      padding: 4px;
      z-index: 10;
      opacity: 0;
      transform: translateY(4px);
      pointer-events: none;
      transition: opacity 0.18s ease, transform 0.18s ease;
    }

    .sort-menu.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

    .sort-menu button {
      width: 100%;
      text-align: left;
      border: none;
      background: transparent;
      color: var(--text);
      font-size: 12px;
      padding: 7px 9px;
      border-radius: 8px;
      cursor: pointer;
    }

    .sort-menu button:hover {
      background: var(--accent-soft);
    }

    .sort-menu button.active {
      background: var(--accent-soft);
      font-weight: 200;
    }

    body.theme-light .sort-wrapper {
      background: #f9fafb;
    }

    .filters-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .filters-spacer {
      flex: 1;
    }

    .filter-chip {
      font-size: 12px;
      padding: 6px 12px;
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light), 0 2px 4px rgba(0,0,0,0.05);
      background: var(--chip-bg);
      color: var(--muted);
      cursor: pointer;
      transition: 0.18s ease;
    }

    .filter-chip:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent-soft), 0 4px 8px rgba(0,0,0,0.1);
    }

    .filter-chip.active {
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
      color: var(--text);
    }

    body.theme-light .filter-chip.active {
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
      color: var(--text);
    }

    .filter-chip .chip-close {
      margin-left: 6px;
      font-size: 11px;
      opacity: 0.8;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      font-size: 12px;
      color: var(--muted);
    }

    .info-row strong {
      color: var(--text);
    }

    .section-header {
      font-size: 14px;
      font-weight: 600;
      margin: 0 0 8px;
      color: var(--text);
    }

    /* ==== INLINE PLAYER SECTION ==== */
    .player-section {
      margin-top: -23px;
      margin-bottom: 18px;
      display: none;
    }

    .player-section.show {
      display: block;
    }

    .player-size {
      display: none !important;
    }
@media (max-width: 480px) {
  #playerCloseBtn {
    display: none !important;
  }
}
@media (max-width: 480px) {
  .player-media {
    margin-top: 12px !important;    /* geserin video agak ke bawah */
  }
}
@media (max-width: 480px) {
  .player-extra {
    margin-top: -1px !important;  /* naik dikit */
  }
      #filterInfo {
    display: none !important;
  }
}

  @media (max-width: 480px) {
  .player-extra {
    flex-direction: column !important; /* ğŸ”¥ selalu vertikal, 2 baris */
    align-items: stretch;
    width: 100%;
    gap: 8px;
  }
  .tag-btn {
    padding: 7px 8px!important;       /* biar kotaknya sama gepeng */
    gap: 3px;
    font-size: 10px!important;        /* ukuran text sama */
    border-radius: 5px!important;     /* curve sama kayak download/playlist */
  }
  .player-extra-row {
    display: flex;
    width: 100%;
    justify-content: space-between;
    gap: 6px;
    margin-right: 0; /* nggak perlu lagi */
  }

  .player-extra-row .download-btn,
  .player-extra-row .playlist-btn,
  .player-extra-row .tag-btn {
    flex: 1 1 0;
    justify-content: center;
  }

  #playerPlaylistMainBtn {
    margin-left: 0;
  }
}


    .player-card {
      background: transparent;
      border-radius: 20px;
      border: none;
      box-shadow: none;
      padding: 0 0 12px;
      animation: playerIn 0.28s cubic-bezier(0.22, 0.61, 0.36, 1);
    }

    body.no-player-anim .player-card {
      animation: none;
    }

    @keyframes playerIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .player-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .drive-logo {
      background: none !important;
      box-shadow: none !important;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .drive-logo svg {
      width: 35px;
      height: 35px;
    }

    .player-title {
      font-size: 16px;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .player-header-right {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .player-pill-btn {
      border-radius: 999px;
      border: 1px solid var(--pill-dark-border);
      background: var(--pill-dark-bg);
      padding: 6px;
      font-size: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.18s ease;
      color: #e5e7eb;
    }

    .player-pill-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    body.theme-light .player-pill-btn {
      background: #e5e7eb;
      border-color: #d1d5db;
      color: #111827;
    }

    body.theme-light .hero-title  {
      color: #ffffff;
    }

    body.theme-light .hero-desc {
      color: #f5c542; 
      text-shadow: 0 2px 5px rgba(0,0,0,0.25);
    }

    .player-pill-btn svg {
      width: 16px;
      height: 16px;
      stroke-width: 2;
      stroke: currentColor;
    }
@media (max-width: 480px) {
  .player-close-btn {
    border-radius: 7px !important;
  }
}
@media (max-width: 480px) {
  #playerBackBtn,
  #playerCloseBtn {
    background: var(--card-bg) !important;
    color: var(--text) !important;
    border: none !important;
    box-shadow: 0 0 0 1px var(--border-light) !important;

    padding: 6px 12px !important;
    border-radius: 6px !important; /* atur curve */
    font-size: 11px !important;
    font-weight: 500;
  }
}
    /* ğŸ”¥ CSS Tambahan untuk ikon SVG Lucide di tombol Back */
    #playerBackBtn svg {
      width: 14px; /* Kecilkan sedikit agar pas dengan ukuran font */
      height: 14px;
      margin: 0;
      display: block;
      /* Pastikan warna sesuai dengan teks */
      stroke: currentColor; 
      fill: none;
    }
    /* Akhir CSS Tambahan */
@media (max-width: 480px) {
  .thumb-wrapper {
    overflow: hidden;
    border-radius: var(--radius-md) !important;

    aspect-ratio: 16 / 10 !important;  /* ğŸ”¥ lebih gepeng dari 16:9 */
  }

  .thumb {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    object-position: center !important;
    border-radius: inherit;
  }
}


    .player-close-btn {
      border-radius: 999px;
      border: 1px solid var(--pill-dark-border);
      background: var(--pill-dark-bg);
      backdrop-filter: blur(4px);
      color: var(--pill-dark-text);
      font-size: 11px;
      padding: 4px 11px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .player-close-btn:hover {
      background: rgba(15,23,42,1);
    }

    body.theme-light .player-close-btn {
      background: #ffffff;
      color: #111827;
      border-color: #e5e7eb;
    }

    .player-body {
      display: grid;
      grid-template-columns: 1.9fr 0.5fr;
      gap: 26px;
      align-items: flex-start;
    }

    .player-media {
      width: 100%;
    }

    .player-video {
      width: 100%;
      aspect-ratio: 16 / 10;
      height: auto;
      border-radius: 14px;
      border: none;
      box-shadow: 0 0 0 1px #23233a, 0 10px 30px rgba(0,0,0,0.3);
      background: #000;
    }

    body.theme-light .player-video {
      box-shadow: 0 0 0 1px #d1d5db, 0 10px 30px rgba(0,0,0,0.1);
    }

    #playerDriveWrap iframe {
      width: 100%;
      aspect-ratio: 16 / 10;
      height: auto;
      border: none;
      border-radius: 14px;
      background: #000;
      box-shadow: 0 0 0 1px #23233a, 0 10px 30px rgba(0,0,0,0.3);
    }

    body.theme-light #playerDriveWrap iframe {
      box-shadow: 0 0 0 1px #d1d5db, 0 10px 30px rgba(0,0,0,0.1);
    }

    .player-meta {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .meta-row {
      display: flex;
      justify-content: flex-start;
      gap: 4px;
      align-items: baseline;
      flex-wrap: wrap;
      margin-bottom: 6px;
    }

    .meta-label {
      color: #7b7ba0;
      font-weight: 500;
    }

    .meta-label::after {
      content: ":";
      margin-right: 4px;
    }

    body.theme-light .meta-label {
      color: #6b7280;
    }

    .meta-value {
      text-align: left;
    }

    .meta-value.clickable {
      color: var(--text) !important;
      cursor: pointer;
      text-decoration: none;
      border-bottom: none;
      opacity: 1;
      transition: color 0.25s ease, opacity 0.25s ease, transform 0.5s ease;
    }

    .meta-value.clickable:hover {
      color: #cf4a46 !important;
      opacity: 1;
      transform: translateY(-1px);
    }

    .player-desc {
      margin-top: 6px;
      margin-bottom: 8px;
      padding-right: 25px;
      font-size: 12px;
      line-height: 1.6;
      color: #d0d0e5;
      border-bottom: 1px solid #4a4a4aa4;
      padding-bottom: 10px;
    }

    body.theme-light .player-desc {
      color: #111827;
    }

    .search-icon svg {
      width: 14px;
      height: 14px;
      opacity: 0.6;
      stroke-linecap: round;
    }
@media (max-width: 480px) {
  .hero-dot,
  .nav-dot,
  .slide-dot {
    background-color: #555 !important; /* abu seperti dark mode */
  }

  .hero-dot.active,
  .nav-dot.active,
  .slide-dot.active {
    background-color: #e81d27 !important; /* merah saat aktif */
  }
}
@media (max-width: 480px) {
  .search-clear-btn {
    margin-left: -12px!important;
  }
}

    /* PLAYER EXTRA: DOWNLOAD + PLAYLIST + TAG */
    .player-extra {
      margin-top: 6px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 12px;
      font-size: 8px;
      align-self: flex-start;
      width: 100%;
    }

    .player-extra-row {
      display: flex;
      align-items: center;
      gap: 11px;
      width: 100%;
    }

    .download-btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light);
      background: var(--card-bg);
      color: var(--text);
      padding: 6px 12px;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: 0.18s ease;
      font-size: 12px;
      white-space: nowrap;
    }

    .download-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent), 0 4px 12px rgba(0,0,0,0.1);
    }

    .download-btn svg {
      width: 16px;
      height: 16px;
      display: block;
    }

    body.theme-light .download-btn {
      background: #ffffff;
    }

    @media (max-width: 480px) {
      .download-btn {
        padding-top: 5px!important;
        padding-bottom: 6px!important;
      }
    }

    .playlist-btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light);
      background: var(--card-bg);
      color: var(--text);
      padding: 6px 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: 0.18s ease;
      white-space: nowrap;
    }

    .playlist-btn svg {
      width: 16px;
      height: 16px;
      display: block;
    }

    .playlist-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent), 0 4px 12px rgba(0,0,0,0.1);
    }

    .playlist-btn.active {
      box-shadow: 0 0 0 1px #6f6f6f;
    }

    body.theme-light .playlist-btn {
      background: #ffffff;
    }

    /* ğŸ”¥ tombol hashtag */
    .tag-btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light);
      background: var(--card-bg);
      color: var(--text);
      padding: 6px 12px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      cursor: pointer;
      font-size: 12px;
      transition: 0.18s ease;
      white-space: nowrap;
    }

    .tag-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent), 0 4px 12px rgba(0,0,0,0.1);
    }

    body.theme-light .tag-btn {
      background: #ffffff;
    }

    /* ==============================
        WIDE PLAYER MODE â€“ VIDEO SAJA
        ============================== */
    .player-section.wide .player-body {
      grid-template-columns: 1fr;
      gap: 16px;
    }

    .player-section.wide .player-media {
      max-width: 100%;
    }

    .player-section.wide .player-video,
    .player-section.wide #playerDriveWrap iframe {
      aspect-ratio: 16 / 9;
      width: 100%;
      height: auto;
    }

    .player-section.wide .player-meta {
      display: none !important;
    }

    /* PREVIEW NORMAL, KECIL SEDIKIT */
    .player-section:not(.wide):not(.cinema) .player-media {
      max-width: 85%;
      margin-left: 0px;
    }

    .player-section:not(.wide):not(.cinema) .player-video,
    .player-section:not(.wide):not(.cinema) #playerDriveWrap iframe {
      width: 100%;
      aspect-ratio: 16 / 9;
      height: auto;
    }

    @media (max-width: 768px) {
      .player-section:not(.wide):not(.cinema) .player-media {
        max-width: 100%;
        margin: 0 auto;
      }
    }

    .player-section:not(.wide):not(.cinema) .player-meta {
      margin-left: -135px;
    }

    /* =========================
        CINEMA MODE
        ========================= */
    body.cinema-mode {
      background: #000 !important;
      overflow: hidden;
    }

    body.cinema-mode .space-bg {
      display: none !important;
    }

    body.cinema-mode .header,
    body.cinema-mode .controls,
    body.cinema-mode .info-row,
    body.cinema-mode #grid,
    body.cinema-mode #emptyState,
    body.cinema-mode #paginationWrap,
    body.cinema-mode #otherVideosHeader,
    body.cinema-mode #toast,
    body.cinema-mode .hero-section {
      display: none !important;
    }

    body.cinema-mode .page {
      max-width: 1150px;
      margin: 0 auto;
      padding: 16px 16px 24px;
    }

    .player-section.cinema {
      margin: 0;
      padding: 0;
    }

    body.cinema-mode .player-card {
      border-radius: 0;
      padding: 0;
      box-shadow: none;
    }

    body.cinema-mode .player-header {
      display: none !important;
    }

    body.cinema-mode .player-body {
      grid-template-columns: 1fr;
      gap: 0;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    body.cinema-mode .player-media {
      max-width: 100%;
      margin: 0 auto;
    }

    body.cinema-mode .player-video,
    body.cinema-mode #playerDriveWrap iframe {
      width: 100%;
      height: auto;
      aspect-ratio: 16 / 9;
      border-radius: 14px;
      border: none;
      background: #000;
      box-shadow: none;
    }

    body.cinema-mode .player-meta,
    body.cinema-mode .player-extra,
    body.cinema-mode .player-desc {
      display: none !important;
    }

    body.cinema-mode .player-close-btn {
      display: none !important;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
    }

    .grid:not(.list-view) {
      column-gap: 18px;
      row-gap: 22px;
    }

    .grid.list-view {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .grid-separator {
      grid-column: 1 / -1;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
      margin-bottom: 4px;
      font-size: 12px;
      color: var(--muted);
    }

    .grid-separator-line {
      flex: 1;
      height: 0;
      border-top: 2px dashed var(--border);
      opacity: 0.5;
    }

    .card {
      position: relative;
      background: var(--card-bg);
      border-radius: var(--radius-lg);
      padding: 8px;
      border: none; 
      box-shadow: var(--shadow-strong), 0 0 0 1px var(--border-light) inset;
      display: flex;
      flex-direction: column;
      gap: 6px;
      cursor: pointer;
      transition: transform 0.25s ease, box-shadow 0.25s ease, background 0.25s ease;
    }

    .card:hover {
      transform: translateY(-3px) scale(1.01);
      box-shadow: 0 15px 35px rgba(0,0,0,0.4), 0 0 0 1px var(--accent-soft) inset, 0 0 20px var(--glow-color);
    }

    body.theme-light .card {
      box-shadow: 0 4px 15px rgba(0,0,0,0.05), 0 0 0 1px var(--border-light);
    }

    body.theme-light .card:hover {
      box-shadow: 0 10px 25px rgba(0,0,0,0.1), 0 0 0 1px var(--accent-soft) inset;
    }

    .grid.list-view .card {
      flex-direction: row;
      align-items: flex-start;
      gap: 10px;
    }

    .thumb-wrapper {
      position: relative;
      border-radius: var(--radius-md);
      overflow: hidden;
      background: linear-gradient(135deg, #2e1548, var(--bg));
      min-height: 100px;
      flex-shrink: 0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }

    body.theme-light .thumb-wrapper {
      background: linear-gradient(135deg, #e5e7eb, #f9fafb);
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }

    .thumb {
      width: 100%;
      height: 120px;
      object-fit: cover;
      display: block;
    }

    .grid.list-view .thumb {
      width: 220px;
      height: 130px;
    }

    .thumb-overlay {
      position: absolute;
      inset: 0;
      background: var(--overlay-grad);
      display: flex;
      align-items: flex-end;
      justify-content: flex-end;
      padding: 6px 7px;
      font-size: 11px;
      color: #f9fafb;
      pointer-events: none;
    }

    .play-pill {
      display: flex;
      align-items: center;
      gap: 8px;
      background: #00000038;
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      font-size: 11px;
      backdrop-filter: blur(6px);
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .play-icon {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      border: 1px solid #ffffffaa;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 9px;
    }

    .card-main {
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
      padding: 4px;
    }

    .card-title {
      font-size: 13px;
      font-weight: 500;
      line-height: 1.3;
    }

    .card-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: var(--muted);
    }
@media (max-width: 480px) {
  .playlist-btn svg {
    width: 14px!important;
    height: 14px;
  }
}

    .empty {
      margin-top: 18px;
      padding: 30px;
      border-radius: var(--radius-lg);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light) inset, 0 10px 30px rgba(0,0,0,0.2);
      background: #060612;
      text-align: center;
      font-size: 13px;
      color: var(--muted);
    }

    body.theme-light .empty {
      background: #f9fafb;
      box-shadow: 0 0 0 1px var(--border-light) inset, 0 5px 15px rgba(0,0,0,0.05);
    }

    .load-more-wrap {
      text-align: center;
      margin-top: 14px;
    }

    .btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light);
      background: var(--card-bg);
      color: var(--text);
      font-size: 12px;
      padding: 7px 14px;
      cursor: pointer;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent), 0 4px 10px rgba(0,0,0,0.1);
    }

    #pagination {
      display: inline-flex;
      gap: 6px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .page-btn {
      border-radius: var(--radius-pill);
      border: none;
      box-shadow: 0 0 0 1px var(--border-light);
      background: var(--card-bg);
      color: var(--text);
      font-size: 12px;
      padding: 5px 10px;
      cursor: pointer;
      min-width: 28px;
      text-align: center;
    }

    .page-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 0 1px var(--accent-soft);
    }

    .page-btn.active {
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px var(--accent);
      font-weight: 600;
    }

    .page-btn[disabled] {
      opacity: 0.4;
      cursor: default;
      transform: none;
      box-shadow: 0 0 0 1px var(--border-light);
    }
@media (max-width: 480px) {
  #otherVideosHeader {
      /* dari player ke judul */
    margin-bottom: 26px !important;  /* dari judul ke list video */
  }
  
}

    #toast {
      position: fixed;
      left: 50%;
      bottom: 80px;
      transform: translateX(-50%) translateY(20px);
      background: rgba(15, 23, 42, 0.95);
      color: #f9fafb;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 12px;
      border: none;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.1), 0 10px 20px rgba(0,0,0,0.3);
      opacity: 0;
      pointer-events: none;
      z-index: 60;
      transition: opacity 0.25s ease, transform 0.25s ease;
    }

    body.theme-light #toast {
      background: rgba(255, 255, 255, 0.98);
      color: #111827;
      box-shadow: 0 0 0 1px rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.1);
    }

    #toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }


@media (max-width: 480px) {
  #playerWideBtn {
    display: none !important;
  }
}


    @media (max-width: 900px) {
      .player-body {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .header {
        flex-direction: column;
        align-items: flex-start;
      }

      .header-right {
        align-self: stretch;
        justify-content: flex-start;
        flex-wrap: wrap;
      }

      .grid.list-view .thumb {
        width: 160px;
        height: 100px;
      }

      .player-section:not(.wide):not(.cinema) .player-meta {
        margin-left: 0 !important;
        max-width: 100%;
        text-align: left;
      }
    }

    @media (max-width: 480px) {
      .header-right {
        display: flex;
        flex-wrap: wrap;
        gap: 11px;
      }

      .grid-separator {
        margin-top: -10px!important;
        margin-bottom: 8px!important;
      }

      .header-small-btn {
        padding: 5px 10px;
        font-size: 10.5px;
        border-radius: 9px;
        min-width: auto;
      }

      .theme-toggle {
        padding: 4px 8px;
        font-size: 9.5px;
        border-radius: 8px;
        min-width: auto;
      }

      .pill-badge {
        padding: 8px 14px;
        font-size: 12px;
        border-radius: var(--radius-pill);
        min-width: auto;
      }

      .sort-chip {
        padding: 20px 14px!important;
        font-size: 12px!important;
        border-radius: 12px!important;
      }

      .header-right {
        gap: 8px;
      }

      .header-small-btn,
      .theme-toggle,
      .pill-badge {
        padding: 9px 9px;
        font-size: 11px;
        border-radius: 12px;
        min-width: auto;
      }

      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
      }

      .hero-section {
        border-radius: 14px !important;
      }
    }

    @media (max-width: 400px) {
      .hero-section {
        height: 225px;
        border-radius: 18px;
        margin-bottom: 16px;
      }

      .hero-content {
        left: 14px;
        right: 14px;
        top: 52%;
        transform: translateY(-50%);
      }

      .hero-meta {
        font-size: 8px;
        margin-bottom: 4px;
      }

      .hero-title {
        font-size: 16px;
        margin-bottom: 4px;
      }

      .hero-desc {
        font-size: 8px;
        -webkit-line-clamp: 2;
        margin-bottom: 12px;
      }

      .hero-btn {
        padding: 2px 9px;
        font-size: 8.5px;
        gap: 2px;
        border-radius: 10px;
      }

      .hero-btn svg {
        width: 10px;
        height: 10px;
      }

      .hero-btn-pink-outline {
        border-width: 1px;
        padding: 3px 8px;
      }

      .hero-btn-primary {
        box-shadow: 0 2px 6px rgba(229, 9, 20, 0.30),
                    0 0 0 1px rgba(229, 9, 20, 0.20) inset;
      }

      .hero-indicators {
        bottom: 10px;
        right: 12px;
      }

      .top-controls-row {
        gap: 6px;
      }

      .sort-btn {
        padding: 6px 10px;
        font-size: 11px;
      }

      .player-actions {
        gap: 6px;
      }

      .player-actions button {
        padding: 8px 10px;
        font-size: 11.5px;
        border-radius: 8px;
      }

      .player-actions button svg {
        width: 14px;
        height: 14px;
      }
    }

    @media (max-width: 480px) {
  .download-btn {
    padding: 4px 8px;
    gap: 3px;
    font-size: 9px;
    border-radius: 5px;
  }
@media (max-width: 480px) {
  .load-more-wrap {
    margin-top: 16px;
  }
  #paginationWrap {
    margin-top: 32px !important;   /* ğŸ”¥ jarak 32px */
  }
  .page-btn {
    padding: 4px 8px;
    font-size: 12px;
    min-width: 28px;
  }
}

  .download-btn svg {
    width: 14px;
    height: 14px;
  }

  .playlist-btn {
    padding: 3px 8px!important;
    gap: 3px;
    font-size: 9px;
    border-radius: 5px!important;
  }

  .playlist-btn svg {
    width: 14px;
    height: 14px;
  }

  .player-extra-row {
      gap: 10px !important; 
  }

  .player-size {
    font-size: 9px;
  }

  
}


    /* ğŸ”¥ MODE MOBILE: sembunyikan detail & deskripsi di player */
    @media (max-width: 768px) {
      .player-meta .meta-row,
      .player-desc {
        display: none !important;
      }

      .player-extra {
        margin-top: 8px;
        gap: 8px;
      }

      .player-extra-row {
        justify-content: space-between;
      }

      .player-extra-row .download-btn,
      .player-extra-row .playlist-btn,
      .player-extra-row .tag-btn {
        flex: 1;
        justify-content: center;
      }

      .player-size {
        display: none !important;
      }
    }
.search-box {
  position: relative;
}

.search-suggestions {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;

  margin-top: 4px;
  padding: 6px 0;
  border-radius: 12px;

  /* ğŸ”¥ Samakan background dengan search-box */
  background: var(--card-bg); 
  box-shadow: 0 0 0 1px var(--border-light), 0 10px 25px rgba(0,0,0,0.35);

  max-height: 260px;
  overflow-y: auto;
  z-index: 30;

  font-size: 0.82rem;
  display: none;
}
.search-suggestion-chip {
  display: none !important;
}
@media (max-width: 480px) {
  .search-box input {
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    display: block !important;
    max-width: 100% !important;
  }
}

@media (max-width: 480px) {
  .pagination button {
    min-width: 50px !important;
    min-height: 45px !important;
    padding: 0 16px !important;
    font-size: 17px !important;
    border-radius: 14px !important;
  }
}
@media (max-width: 383px) {
  .filter-chip:has(:where(*:contains("Artis:"), *:contains("Label:"))) {
    display: none !important;
  }
}

/* 1 item suggestion */
.search-suggestion-item {
  padding: 6px 12px;
  display: flex;
  flex-direction: column;
  gap: 2px;
  cursor: pointer;
  transition: background 0.16s ease, transform 0.08s ease;
}

.search-suggestion-item:hover {
  background: rgba(148, 27, 27, 0.5);
  transform: translateY(-1px);
}

/* selected via keyboard */
.search-suggestion-item.active {
  background: linear-gradient(135deg, #ef4444, #b91c1c);
}

/* baris pertama (judul saran) */
.search-suggestion-main {
  color: #f9fafb;
  font-weight: 500;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* baris kedua (context: Label, Artis, Kode, dll) */
.search-suggestion-meta {
  color: #9ca3af;
  font-size: 0.75rem;
  display: flex;
  gap: 6px;
  align-items: center;
}
@media (max-width: 480px) {
  /* kasih ruang ekstra di kanan buat X */
  .search-box {
    padding-right: 32px !important;
  }

  .search-clear-btn {
    position: absolute !important;
    right: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;

    margin-left: 0 !important;
    /* ukuran fix biar nggak ngedorong tinggi */
    width: 18px !important;
    height: 18px !important;

    display: none; /* JS kamu masih pakai inline-flex nanti */
    align-items: center;
    justify-content: center;

    padding: 0 !important;
    font-size: 14px !important;
    line-height: 1 !important;
  }
}

.search-suggestion-chip {
  padding: 1px 6px;
  border-radius: 999px;
  border: 1px solid rgba(248, 113, 113, 0.7);
  font-size: 0.68rem;
  color: #fecaca;
}
/* ===== Shimmer Loading ===== */
.grid-shimmer {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
  gap: 12px;
  padding: 12px 0;
}

.shimmer-card {
  background: rgba(255,255,255,0.06);
  border-radius: 14px;
  overflow: hidden;
  position: relative;
  height: 180px;
}

.shimmer-thumb {
  height: 120px;
  background: rgba(255,255,255,0.08);
  position: relative;
  overflow: hidden;
}

.shimmer-line {
  height: 10px;
  width: 80%;
  margin: 10px auto;
  border-radius: 6px;
  background: rgba(255,255,255,0.1);
  position: relative;
  overflow: hidden;
}

/* glow bergerak */
.shimmer-thumb::after,
.shimmer-line::after {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  height: 100%;
  width: 100%;
  background: linear-gradient(
    90deg,
    transparent,
    rgba(255,255,255,0.25),
    transparent
  );
  animation: shimmerMove 1.4s infinite;
}

@keyframes shimmerMove {
  0% { left: -100%; }
  100% { left: 100%; }
}

  </style>
  <body class="theme-dark">
  <div class="space-bg">
    <span class="space-star star-1"></span>
    <span class="space-star star-2"></span>
    <span class="space-star star-3"></span>
    <span class="space-star star-4"></span>
    <span class="space-star star-5"></span>
    <span class="space-star star-6"></span>
    <span class="space-star star-7"></span>
    <span class="space-star star-8"></span>
  </div>

  <div class="page">
    <div class="header">
      <div class="brand">
        <div class="brand-logo drive-logo">
          <svg viewBox="0 0 24 24">
            <path fill="#0F9D58" d="M7.5 3L2 12l3.75 6.5L11.3 9.5 7.5 3z"></path>
            <path fill="#4285F4" d="M16.5 3h-9l3.8 6.5L18 18.5 22 12 16.5 3z"></path>
            <path fill="#F4B400" d="M5.75 18.5L8.5 22h9l-3.5-6-8.25 2.5z"></path>
          </svg>
        </div>
        <div>
          <div class="brand-text-title">drive flix</div>
          <div class="brand-text-sub">made by ndra</div>
        </div>
      </div>
      <div class="header-right">
        <button class="header-small-btn" id="homeBtn">ğŸ  Home</button>
        <button class="header-small-btn" id="playlistBtn">ğŸ“ Playlist</button>
        <button class="header-small-btn" id="historyBtn">ğŸ•’ History</button>
        <button class="theme-toggle" id="themeToggle">
          <span id="themeIcon">ğŸŒ™</span>
          <span id="themeLabel">Dark</span>
        </button>
        <div class="pill-badge">
          <span class="pill-dot"></span>
          <span id="clockText">
            <span id="clockHours">--</span>
            <span id="clockColon">:</span>
            <span id="clockMinutes">--</span>
          </span>
        </div>
      </div>
    </div>

    <div id="heroCarousel" class="hero-section"></div>

    <div class="controls">
      <div class="top-controls-row">
 <div class="search-box" id="searchBox">
  <span class="search-icon">
    <svg viewBox="0 0 24 24">
      <circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2" fill="none"/>
      <line x1="16" y1="16" x2="21" y2="21" stroke="currentColor" stroke-width="2"/>
    </svg>
  </span>

  <input id="searchInput" type="text" placeholder="Cari judul atau kategori..." />

  <!-- ğŸ”¥ Tombol clear / reset -->
  <button type="button" id="searchClearBtn" class="search-clear-btn">âœ•</button>

  <!-- ğŸ”½ Suggestion dropdown -->
  <div id="searchSuggestions" class="search-suggestions"></div>
</div>


        <div class="sort-wrapper" id="sortWrapper">
          <span class="sort-label">Urutkan</span>
          <button class="sort-trigger" id="sortTrigger">
            <span id="sortTriggerLabel">Terbaru</span>
            <span class="sort-trigger-icon">â–¾</span>
          </button>
          <div class="sort-menu" id="sortMenu">
            <button data-value="newest" class="active">Terbaru</button>
            <button data-value="oldest">Terlama</button>
          </div>
        </div>
      </div>
      <div class="filters-row" id="filters"></div>
    </div>

    <div class="info-row">
      <div id="videoInfo">
        <strong id="countText">0</strong>
        <span id="countSuffix"> video ditemukan di</span> 
        <span id="modeLabel">Semua video</span>
      </div>
      <div id="filterInfo">
        Filter kategori: <strong id="activeFilterLabel">Semua</strong>
      </div>
    </div>

    <section id="playerSection" class="player-section">
      <div class="player-card">
        <div class="player-header">
          <div class="player-title" id="playerTitle">Judul Video</div>
          <div class="player-header-right">
          <button id="playerBackBtn" class="player-close-btn">
             <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-step-back"><line x1="18" x2="18" y1="20" y2="4"/><polygon points="15 20 4 12 15 4"/></svg>
            </button>


            <button id="playerWideBtn" class="player-pill-btn" title="Perbesar tampilan">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path d="M4 9V4h5M15 4h5v5M4 15v5h5M15 20h5v-5" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
            </button>
            <button id="playerCloseBtn" class="player-close-btn">
              <span class="home-icon">ğŸ </span> Home
            </button>
          </div>
        </div>

        <div class="player-body">
          <div class="player-media">
            <video id="playerVideo" class="player-video" controls>
              <source id="playerVideoSource" src="" type="video/mp4" />
              Browser kamu tidak mendukung pemutar video HTML5.
            </video>
            <div id="playerDriveWrap" style="display:none;"></div>
          </div>

          <div class="player-meta">
            <div class="meta-row">
              <span class="meta-label">Kode</span>
              <span class="meta-value" id="playerCode"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Kategori</span>
              <span class="meta-value" id="playerCategory"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Studio</span>
              <span class="meta-value" id="playerStudio"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Label</span>
              <span class="meta-value clickable" id="playerLabel"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Aktor</span>
              <span class="meta-value" id="playerActor"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Aktris</span>
              <span class="meta-value clickable" id="playerActress"></span>
            </div>
            <div class="meta-row">
              <span class="meta-label">Upload</span>
              <span class="meta-value" id="playerDate"></span>
            </div>

            <div class="player-desc" id="playerDescription"></div>

            <div class="player-extra">
              <div class="player-extra-row">
                <a id="playerDownload" class="download-btn" href="#" target="_blank" rel="noopener">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="#0F9D58" d="M7.5 3L2 12l3.75 6.5L11.3 9.5 7.5 3z"></path>
                    <path fill="#4285F4" d="M16.5 3h-9l3.8 6.5L18 18.5 22 12 16.5 3z"></path>
                    <path fill="#F4B400" d="M5.75 18.5L8.5 22h9l-3.5-6-8.25 2.5z"></path>
                  </svg>
                  <span class="download-label"></span>
                </a>
                <span class="player-size" id="playerSize"></span>

                <button id="playerPlaylistMainBtn" type="button" class="playlist-btn" title="Tambah ke playlist">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path fill="currentColor" d="M6 3h12v18l-6-4-6 4z"></path>
                  </svg>
                  <span></span>
                </button>
              </div>

              <div class="player-extra-row">
                <button id="playerLabelBtn" type="button" class="tag-btn">
                  #Label
                </button>

                <button id="playerArtistBtn" type="button" class="tag-btn">
                  #Artis
                </button>
              </div>
            </div>

          </div>
        </div>
      </div>
    </section>


    
    <div id="otherVideosHeader" class="section-header" style="display:none;">
      Video lainnya
    </div>

    <div id="grid" class="grid"></div>
    <div id="emptyState" class="empty" style="display:none;">
      Tidak ada video yang cocok dengan pencarian / filter kamu.  
      Coba kata kunci lain ya. ğŸ™‚
    </div>
<div id="gridShimmer" class="grid-shimmer" style="display:none;"></div>

    <div id="paginationWrap" class="load-more-wrap" style="display:none;">
      <div id="pagination"></div>
    </div>
  </div>

  <div id="toast"></div>

  <script>
const gridShimmerEl = document.getElementById("gridShimmer");

function showGridShimmer() {
  if (!gridShimmerEl) return;

  gridShimmerEl.style.display = "grid";
  gridEl.style.display = "none";

  // bikin 8 shimmer card
  gridShimmerEl.innerHTML = "";
  for (let i = 0; i < 8; i++) {
    gridShimmerEl.innerHTML += `
      <div class="shimmer-card">
        <div class="shimmer-thumb"></div>
        <div class="shimmer-line"></div>
        <div class="shimmer-line" style="width:60%;"></div>
      </div>
    `;
  }
}

function hideGridShimmer() {
  if (!gridShimmerEl) return;
  gridShimmerEl.style.display = "none";
  gridEl.style.display = "grid";
}



    const STORAGE_KEYS = {
      THEME: "gallery-theme",
      PLAYLIST: "gallery-playlist",
      HISTORY: "gallery-history"
    };

    // ====== JAM DI HEADER ======
    const clockText = document.getElementById("clockText");
    const clockHours  = document.getElementById("clockHours");
    const clockMinutes = document.getElementById("clockMinutes");
    const clockColon  = document.getElementById("clockColon");

    function updateClock() {
      if (!clockHours || !clockMinutes || !clockColon) return;
      const now = new Date();
      const hh = String(now.getHours()).padStart(2, "0");
      const mm = String(now.getMinutes()).padStart(2, "0");
      const ss = now.getSeconds();
      clockHours.textContent = hh;
      clockMinutes.textContent = mm;
      clockColon.style.opacity = ss % 2 === 0 ? 1 : 0;
    }
    updateClock();
    setInterval(updateClock, 1000);

    function driveDirect(linkOrId) {
      if (!linkOrId) return "";
      if (linkOrId.startsWith("http")) {
        const match = linkOrId.match(/\/d\/([^/]+)/);
        const id = match ? match[1] : linkOrId;
        return `https://drive.google.com/uc?export=download&id=${id}`;
      }
      return `https://drive.google.com/uc?export=download&id=${linkOrId}`;
    }
    function driveThumbnail(fileId, size = 800) {
      return `https://drive.google.com/thumbnail?id=${fileId}&sz=w${size}`;
    }

    const DRIVE_ID = "1iqvBoMJ50rbyCwtgeyobSU3bgfPsNrYV";

    const DRIVE_ICON_SVG = `
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path fill="#0F9D58" d="M7.5 3L2 12l3.75 6.5L11.3 9.5 7.5 3z"></path>
        <path fill="#4285F4" d="M16.5 3h-9l3.8 6.5L18 18.5 22 12 16.5 3z"></path>
        <path fill="#F4B400" d="M5.75 18.5L8.5 22h9l-3.5-6-8.25 2.5z"></path>
      </svg>
    `;

    /* ====== VIDEO LIST ====== */
    const videos = [
      {
        id: 1,
        title: "City Night From Google Drive",
        duration: "12:34",
        durationSec: 12 * 60 + 34,
        category: "Cinematic",
        thumb: driveThumbnail(DRIVE_ID),
        src: driveDirect(`https://drive.google.com/file/d/${DRIVE_ID}/view?usp=drive_link`),
        embed: `https://drive.google.com/file/d/${DRIVE_ID}/preview`,
        date: "2025-10-12",
        description: "Contoh video yang diputar langsung dari Google Drive melalui galeri ini.",
        kode: "MV-001",
        studio: "City Studio",
        label: "SOD Create",
        actor: "John Doe",
        actress: "Kamiki Rei",
        size: "120 MB",
        downloadUrl: driveDirect(DRIVE_ID)
      },
      {
        id: 2,
        title: "Cozy Rain on Window",
        duration: "08:20",
        durationSec: 8 * 60 + 20,
        category: "Relax",
        thumb: "https://images.pexels.com/photos/110874/pexels-photo-110874.jpeg?auto=compress&cs=tinysrgb&w=800",
        src: "sample2.mp4",
        date: "2025-09-20",
        description: "Suasana hujan yang menenangkan, pas buat ambience kerja atau belajar.",
        kode: "MV-002",
        studio: "Calm Studio",
        label: "START",
        actor: "Adam Calm",
        actress: "Remu Suzumori",
        size: "85 MB",
        downloadUrl: "sample2.mp4"
      },
      {
        id: 3,
        title: "Product Showcase Camera",
        duration: "03:45",
        durationSec: 3 * 60 + 45,
        category: "Cinematic",
        thumb: "https://images.pexels.com/photos/212372/pexels-photo-212372.jpeg?auto=compress&cs=tinysrgb&w=800",
        src: "sample3.mp4",
        date: "2025-10-05",
        description: "Video b-roll kamera dengan lighting studio minimalis untuk konten promosi.",
        kode: "MV-003",
        studio: "Gear Studio",
        label: "SONE",
        actor: "Kevin Lens",
        actress: "Suzu Honjou",
        size: "60 MB",
        downloadUrl: "sample3.mp4"
      },
      {
        id: 4,
        title: "Street Night Vibes",
        duration: "10:02",
        durationSec: 10 * 60 + 2,
        category: "Cinematic",
        thumb: "https://images.pexels.com/photos/315191/pexels-photo-315191.jpeg?auto=compress&cs=tinysrgb&w=800",
        src: "sample4.mp4",
        date: "2025-08-30",
        description: "Footage jalanan kota di malam hari dengan lampu neon colorful.",
        kode: "MV-004",
        studio: "Neon Studio",
        label: "SOD Create",
        actor: "Leo Night",
        actress: "Kamiki Rei",
        size: "95 MB",
        downloadUrl: "sample4.mp4"
      },
      {
        id: 5,
        title: "Remu Suzumori - Soft Light Portrait",
        duration: "04:45",
        durationSec: 4 * 60 + 45,
        category: "Relax",
        thumb: "https://images.pexels.com/photos/2777898/pexels-photo-2777898.jpeg?auto=compress&cs=tinysrgb&w=800",
        src: "sample_remu1.mp4",
        date: "2025-08-25",
        description: "Portrait ambience dengan tone lembut dan lighting soft ala studio.",
        kode: "RMU-001",
        studio: "Soft Studio",
        label: "START",
        actor: "â€”",
        actress: "Remu Suzumori",
        size: "52 MB",
        downloadUrl: "sample_remu1.mp4"
      },
      {
        id: 5,
        title: "Remu Suzumori - Soft Light Portrait",
        duration: "04:45",
        durationSec: 4 * 60 + 45,
        category: "Relax",
        thumb: "https://images.pexels.com/photos/2777898/pexels-photo-2777898.jpeg?auto=compress&cs=tinysrgb&w=800",
        src: "sample_remu1.mp4",
        date: "2025-08-25",
        description: "Portrait ambience dengan tone lembut dan lighting soft ala studio.",
        kode: "RMU-001",
        studio: "Soft Studio",
        label: "START",
        actor: "â€”",
        actress: "Remu Suzumori",
        size: "52 MB",
        downloadUrl: "sample_remu1.mp4"
      },
        /* ğŸ”¥ ARTIS BARU TAMBAHAN BUAT TEST */
 {
    id: 6,
    title: "Remu Suzumori - Studio Chill Session",
    duration: "05:20",
    durationSec: 5 * 60 + 20,
    category: "Relax", // penting: biar tetap masuk tab ARTIS (Relax)
    thumb: "https://images.pexels.com/photos/1181686/pexels-photo-1181686.jpeg?auto=compress&cs=tinysrgb&w=800",
    src: "sample_remu2.mp4",
    date: "2025-09-05",
    description: "Session santai di studio dengan vibe hangat dan cozy ala Remu.",
    kode: "RMU-002",
    studio: "Soft Studio",
    label: "START",
    actor: "â€”",
    actress: "Remu Suzumori", // ğŸ”¥ sama, biar kebaca 1 folder artis
    size: "64 MB",
    downloadUrl: "sample_remu2.mp4"
  }
];
    const categories = ["Semua", "Cinematic", "Relax"];

    const categoryLabelMap = {
      "Semua": "Semua",
      "Cinematic": "Label",
      "Relax": "Artis"
    };

    const state = {
      search: "",
      category: "Semua",
      subFilter: null,
      sort: "newest",
      mode: "all",
      page: 1,
      perPage: 15
    };
    let searchIndex = [];
let suggestionActiveIndex = -1; // buat navigasi keyboard
let searchSuggestTimer = null;
let searchGridTimer = null;

function buildSearchIndex() {
  // reset
  searchIndex = [];

  const baseList = videos.slice();

  baseList.forEach(video => {
    const title = video.title || "";
    const label = video.label || "";
    const actress = video.actress || "";
    const kode = video.kode || "";
    const categoryLabel = categoryLabelMap[video.category] || video.category;

    // ğŸ¬ judul video
    if (title) {
      searchIndex.push({
        type: "title",
        query: title.toLowerCase(),
        display: title,
        meta: categoryLabel,
        extra: kode ? `Kode: ${kode}` : "",
        action: () => {
          // set search dan filter pakai judul
          searchInput.value = title;
          state.search = title;
          state.page = 1;
          renderGrid();
        }
      });
    }

    // ğŸ· label
   if (label) {
  searchIndex.push({
    type: "label",
    query: label.toLowerCase(),
    display: label,
    meta: "Label",
    extra: "",
    action: () => {
      // langsung buka folder label
      state.mode = "all";
      state.category = "Cinematic";
      state.subFilter = { type: "label", value: label };
      state.page = 1;
      // âŒ jangan utak-atik searchInput di sini, sudah di-handle applySuggestionItem
      state.search = "";
      renderFilters();
      renderGrid();
    }
  });
}

if (actress) {
  searchIndex.push({
    type: "artist",
    query: actress.toLowerCase(),
    display: actress,
    meta: "Artis",
    extra: "",
    action: () => {
      // langsung buka folder artis
      state.mode = "all";
      state.category = "Relax";
      state.subFilter = { type: "artist", value: actress };
      state.page = 1;
      state.search = "";
      renderFilters();
      renderGrid();
    }
  });
}


    // ğŸ”¢ kode video
    if (kode) {
      searchIndex.push({
        type: "kode",
        query: kode.toLowerCase(),
        display: kode,
        meta: "Kode",
        extra: title,
        action: () => {
          searchInput.value = kode;
          state.search = kode;
          state.page = 1;
          renderGrid();
        }
      });
    }
  });

  // optional: buang duplikat by display+type
  const uniqueMap = new Map();
  searchIndex.forEach(item => {
    const key = item.type + "|" + item.display;
    if (!uniqueMap.has(key)) uniqueMap.set(key, item);
  });
  searchIndex = Array.from(uniqueMap.values());
}

function hideSearchSuggestions() {
  if (searchSuggestionsEl) {
    searchSuggestionsEl.style.display = "none";
    searchSuggestionsEl.innerHTML = "";
  }
  suggestionActiveIndex = -1;
}

function renderSearchSuggestions(list) {
  if (!searchSuggestionsEl) return;

  if (!list.length) {
    hideSearchSuggestions();
    return;
  }

  const html = list
    .map((item, idx) => {
      const chipLabel =
        item.type === "title" ? "Judul" :
        item.type === "label" ? "Label" :
        item.type === "artist" ? "Artis" :
        item.type === "kode" ? "Kode" :
        "Item";

      return `
        <div class="search-suggestion-item" data-index="${idx}">
          <div class="search-suggestion-main">${item.display}</div>
          <div class="search-suggestion-meta">
            <span class="search-suggestion-chip">${chipLabel}</span>
            ${
              item.meta
                ? `<span>${item.meta}</span>`
                : ""
            }
            ${
              item.extra
                ? `<span>â€¢ ${item.extra}</span>`
                : ""
            }
          </div>
        </div>
      `;
    })
    .join("");

  searchSuggestionsEl.innerHTML = html;
  searchSuggestionsEl.style.display = "block";

 Array.from(
  searchSuggestionsEl.querySelectorAll(".search-suggestion-item")
).forEach((el, idx) => {
  el.addEventListener("click", () => {
    const item = list[idx];
    applySuggestionItem(item);   // ğŸ”¥ pakai helper
  });
});

suggestionActiveIndex = -1;

suggestionActiveIndex = -1;

}


function updateSearchSuggestions(query) {
  if (!searchSuggestionsEl) return;

  const q = (query || "").toLowerCase().trim();
  if (!q) {
    hideSearchSuggestions();
    return;
  }

  // ğŸ” cek posisi sekarang
  const isLabelRoot =
    state.category === "Cinematic" && !state.subFilter; // tab LABEL (folder)
  const isArtistRoot =
    state.category === "Relax" && !state.subFilter;      // tab ARTIS (folder)

  // ğŸ”§ base list suggestion sesuai context
  let baseList = searchIndex;

  if (isLabelRoot) {
    // lagi lihat daftar folder label â†’ cuma tampilkan suggestion type "label"
    baseList = baseList.filter(item => item.type === "label");
  } else if (isArtistRoot) {
    // lagi lihat daftar folder artis â†’ cuma tampilkan suggestion type "artist"
    baseList = baseList.filter(item => item.type === "artist");
  }
  // kalau posisi lain (home, playlist, history, dalam folder) â†’ pakai semua type

  // ambil maksimal 8 hasil yang match query
  const filtered = baseList
    .filter(item => item.query.includes(q))
    .slice(0, 8);

  renderSearchSuggestions(filtered);

  // simpan list yg dipakai terakhir untuk keyboard nav
  searchSuggestionsEl._currentList = filtered;
}

function applySuggestionItem(item) {
  if (!item) return;

  if (searchInput) {
    // ğŸ”¹ Selalu pakai teks utama suggestion buat isi search bar
    searchInput.value = item.display;
    searchInput.setAttribute("placeholder", "");
    state.page = 1;

    // ğŸ”¹ Hanya title/kode yang dipakai sebagai search text
    if (item.type === "title" || item.type === "kode") {
      state.search = item.display;
    } else {
      // label & artist pakai folder filter, jadi search dikosongin aja
      state.search = "";
    }

    // ğŸ”¹ Nyalain tombol X kalau ada teks
    if (searchClearBtn) {
      searchClearBtn.style.display =
        searchInput.value.trim() ? "inline-flex" : "none";
    }
  }

  // ğŸ”¹ Tutup dropdown + kasih efek shimmer
  hideSearchSuggestions();
  showGridShimmer();

  setTimeout(() => {
    if (typeof item.action === "function") {
      item.action();   // buka folder / filter / dsb
    } else {
      renderGrid();
    }
    hideGridShimmer();
  }, 700);
}


// ğŸ”§ Atur jumlah video per halaman sesuai ukuran layar
function applyResponsivePerPage() {
  const isMobile = window.innerWidth <= 480;
  // 6 item = 3 baris x 2 kolom (kalau layout kamu 2 kolom di mobile)
  state.perPage = isMobile ? 6 : 15;
}
let resizeTimer;
window.addEventListener("resize", () => {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(() => {
    const before = state.perPage;
    const isMobile = window.innerWidth <= 480;
    const after = isMobile ? 6 : 15;

    if (before !== after) {
      state.perPage = after;
      state.page = 1;       // balik ke halaman 1 biar aman
      renderGrid();
    }
  }, 200); // kecilin spam render saat user resize
});


    const gridEl = document.getElementById("grid");
    const emptyEl = document.getElementById("emptyState");
    const paginationWrapEl = document.getElementById("paginationWrap");
    const paginationEl = document.getElementById("pagination");
    const countTextEl = document.getElementById("countText");
    const activeFilterLabelEl = document.getElementById("activeFilterLabel");
    const filtersEl = document.getElementById("filters");
    const searchInput = document.getElementById("searchInput");
    const searchSuggestionsEl = document.getElementById("searchSuggestions");
const searchClearBtn = document.getElementById("searchClearBtn");
    function updateSearchPlaceholder() {
  if (!searchInput) return;

  let text = "Cari judul atau kategori...";

  const isRootHome =
    state.mode === "all" &&
    state.category === "Semua" &&
    !state.subFilter;

  // ğŸ“Œ Beranda semua video
  if (isRootHome) {
    text = "Cari judul, label, atau artis...";
  }

  // ğŸ“Œ Tab LABEL (pilih folder label)
  else if (state.category === "Cinematic" && !state.subFilter) {
    text = "Cari nama label...";
  }

  // ğŸ“Œ Tab ARTIS (pilih folder artis)
  else if (state.category === "Relax" && !state.subFilter) {
    text = "Cari nama artis...";
  }

  // ğŸ“‚ Di dalam folder label
  else if (
    state.subFilter &&
    state.subFilter.type === "label"
  ) {
    text = `Cari video dilabel ${state.subFilter.value}...`;
  }

  // ğŸ­ Di dalam folder artis
  else if (
    state.subFilter &&
    state.subFilter.type === "artist"
  ) {
    text = `Cari video di artis ${state.subFilter.value}...`;
  }

  // ğŸ§ Mode playlist
  if (state.mode === "playlist") {
    text = "Cari video di playlist kamu...";
  }

  // ğŸ•’ Mode history
  if (state.mode === "history") {
    text = "Cari di riwayat tontonan...";
  }

  searchInput.placeholder = text;
}

    const countSuffixEl = document.getElementById("countSuffix");
    const searchBoxWrap = document.getElementById("searchBox");
    const modeLabelEl = document.getElementById("modeLabel");
    const filterInfoEl = document.getElementById("filterInfo");
    const videoInfoEl = document.getElementById("videoInfo");
    const otherVideosHeader = document.getElementById("otherVideosHeader");

    const sortWrapper = document.getElementById("sortWrapper");
    const sortTrigger = document.getElementById("sortTrigger");
    const sortTriggerLabel = document.getElementById("sortTriggerLabel");
    const sortMenu = document.getElementById("sortMenu");

    const playlistBtn = document.getElementById("playlistBtn");
    const historyBtn = document.getElementById("historyBtn");
    const homeBtn = document.getElementById("homeBtn");

    const playerSection = document.getElementById("playerSection");
    const playerTitleEl = document.getElementById("playerTitle");
    const playerVideoEl = document.getElementById("playerVideo");
    const playerVideoSourceEl = document.getElementById("playerVideoSource");
    const playerDriveWrap = document.getElementById("playerDriveWrap");
    const playerCategoryEl = document.getElementById("playerCategory");
    const playerDateEl = document.getElementById("playerDate");
    const playerDescEl = document.getElementById("playerDescription");
    const playerCodeEl = document.getElementById("playerCode");
    const playerStudioEl = document.getElementById("playerStudio");
    const playerLabelEl = document.getElementById("playerLabel");
    const playerActorEl = document.getElementById("playerActor");
    const playerActressEl = document.getElementById("playerActress");
    const playerCloseBtn = document.getElementById("playerCloseBtn");
    const playerDownloadEl = document.getElementById("playerDownload");
    const playerSizeEl = document.getElementById("playerSize");
    const playerWideBtn = document.getElementById("playerWideBtn");
    const playerPlaylistMainBtn = document.getElementById("playerPlaylistMainBtn");
    const playerLabelBtn = document.getElementById("playerLabelBtn");
    const playerArtistBtn = document.getElementById("playerArtistBtn");
    const playerBackBtn = document.getElementById("playerBackBtn");

    const heroCarousel = document.getElementById("heroCarousel"); 

    const body = document.body;
    const themeToggleBtn = document.getElementById("themeToggle");
    const themeIcon = document.getElementById("themeIcon");
    const themeLabel = document.getElementById("themeLabel");

    const toastEl = document.getElementById("toast");
    // stack riwayat video di player (buat tombol Back)
    let playerHistoryStack = [];
    let isNavigatingBack = false;

    // ğŸ”™ untuk kembali ke preview setelah close hashtag
    let lastHashtagSourceId = null;

    // sembunyiin carousel ketika search fokus
    searchInput.addEventListener("focus", () => {
      heroCarousel.classList.add("is-hidden");
    });

    searchInput.addEventListener("blur", () => {
      if (!searchInput.value.trim()) {
        checkCarouselVisibility();
      }
    });
if (searchClearBtn && searchInput) {
  searchClearBtn.addEventListener("click", () => {
    // kosongkan input
    searchInput.value = "";
    // reset state pencarian
    state.search = "";
    state.page = 1;

    // matikan suggestion + shimmer
    hideSearchSuggestions();
    hideGridShimmer();

    // render ulang semua video (mode sekarang tetap dihormati)
    renderGrid();

    // fokus balik ke input biar enak
    searchInput.focus();

    // sembunyikan tombol X lagi
    searchClearBtn.style.display = "none";
  });
}

    function loadFromStorage(key, fallback) {
      try {
        const data = localStorage.getItem(key);
        return data ? JSON.parse(data) : fallback;
      } catch {
        return fallback;
      }
    }
    function saveToStorage(key, value) {
      try {
        localStorage.setItem(key, JSON.stringify(value));
      } catch {}
    }

    function parseDate(str) {
      return new Date(str);
    }

    function showToast(message) {
      toastEl.textContent = message;
      toastEl.classList.add("show");
      clearTimeout(showToast._timeout);
      showToast._timeout = setTimeout(() => {
        toastEl.classList.remove("show");
      }, 1800);
    }

    function applyTheme(theme) {
      if (theme === "light") {
        body.classList.remove("theme-dark");
        body.classList.add("theme-light");
        themeIcon.textContent = "â˜€ï¸";
        themeLabel.textContent = "Light";
      } else {
        body.classList.remove("theme-light");
        body.classList.add("theme-dark");
        themeIcon.textContent = "ğŸŒ™";
        themeLabel.textContent = "Dark";
      }
      saveToStorage(STORAGE_KEYS.THEME, theme);
    }

    const savedTheme = loadFromStorage(STORAGE_KEYS.THEME, "dark");
    applyTheme(savedTheme === "light" ? "light" : "dark");

    themeToggleBtn.addEventListener("click", () => {
      const current = body.classList.contains("theme-light") ? "light" : "dark";
      const next = current === "light" ? "dark" : "light";
      applyTheme(next);
    });

    function uniqueValues(arr) {
      return Array.from(new Set(arr.filter(Boolean)));
    }

    /* =========================================
        HERO CAROUSEL LOGIC (MODIFIKASI UNTUK CIRCULAR SWIPE)
        ========================================= */
    let carouselInterval;
    let carouselResumeTimeout; // ğŸ”¥ jeda sebelum auto jalan lagi
    let heroSlideCount = 0;    // jumlah slide aktif
    let currentSlideIndex = 0;  // index slide yang sedang tampil
    let slideDomElements = []; // ğŸ”¥ Menyimpan elemen DOM slide

    // ====== CAROUSEL AUTO DELAY UTILS ======
function clearCarouselTimers() {
  if (carouselInterval) {
    clearInterval(carouselInterval);
    carouselInterval = null;
  }
  if (carouselResumeTimeout) {
    clearTimeout(carouselResumeTimeout);
    carouselResumeTimeout = null;
  }
}

function pauseAutoCarousel() {
  clearCarouselTimers();
  if (heroSlideCount <= 1) return;

  // mulai lagi setelah 15 detik setelah user geser
  carouselResumeTimeout = setTimeout(() => {
    startCarouselInterval(heroSlideCount);
  }, 15000);
}

    // =======================================

    // ğŸ”€ acak semua video dalam folder label/artis
    function shuffleFolder(kind, value) {
      if (!value) return;
      const baseList = getModeBaseList();
      const target = value.toLowerCase();
      const list = baseList.filter(v =>
        kind === "label"
          ? (v.label || "").toLowerCase() === target
          : (v.actress || "").toLowerCase() === target
      );
      if (!list.length) return;
      const randomVideo = list[Math.floor(Math.random() * list.length)];
      openPlayerInline(randomVideo.id);
    }
    
function renderCarousel() {
  heroCarousel.innerHTML = "";

  const isFolderLabel =
    state.category === "Cinematic" &&
    state.subFilter &&
    state.subFilter.type === "label";

  const isFolderArtist =
    state.category === "Relax" &&
    state.subFilter &&
    state.subFilter.type === "artist";

  const baseList = getModeBaseList();
  let slides = [];
  let contextType = "history";
  let folderKind = "";
  let folderName = "";
  let totalFolderVideos = 0;

  // ğŸ” cek apakah benar-benar di halaman beranda root
  const isRootHome =
    state.mode === "all" &&
    state.category === "Semua" &&
    !state.subFilter;

  // flag buat tahu kita pakai history atau fallback
  let usedHistorySlides = false;

  // ğŸ“‚ MODE FOLDER LABEL / ARTIS (di semua mode: all/playlist/history)
  if (isFolderLabel || isFolderArtist) {
    const target = (state.subFilter.value || "").toLowerCase();
    const folderVideos = baseList
      .filter(v =>
        isFolderLabel
          ? (v.label || "").toLowerCase() === target
          : (v.actress || "").toLowerCase() === target
      )
      .sort((a, b) => parseDate(b.date) - parseDate(a.date));

    if (folderVideos.length > 0) {
      contextType = isFolderLabel ? "folder-label" : "folder-artist";
      folderKind = isFolderLabel ? "Label" : "Artis";
      folderName = state.subFilter.value;
      totalFolderVideos = folderVideos.length;
      slides = folderVideos.slice(0, 3);
    }
  }

  // ğŸ  MODE HOME (history + fallback 3 video terbaru)
  if (contextType === "history") {
    const baseList = getModeBaseList()
      .slice()
      .sort((a, b) => parseDate(b.date) - parseDate(a.date)); // terbaru duluan

    const historyIds = getHistory(); // urutan sudah dari terbaru
    const historyVideos = historyIds
      .map(id => baseList.find(v => v.id === id))
      .filter(Boolean);

    let resultSlides = [];

    if (historyVideos.length > 0) {
      // ğŸ”¥ Slide pertama = video terakhir ditonton
      resultSlides.push(historyVideos[0]);

      // ğŸ”¥ Tambahkan video lain sampai total 3 slide
      const usedIds = new Set(resultSlides.map(v => v.id));
      const extraVideos = baseList.filter(v => !usedIds.has(v.id));

      const need = 3 - resultSlides.length;
      if (need > 0) {
        resultSlides = resultSlides.concat(extraVideos.slice(0, need));
      }
    } else {
      // ğŸ”¥ User baru â†’ ambil 3 video terbaru
      resultSlides = baseList.slice(0, 3);
    }

    slides = resultSlides;
  }

  // label tombol play di hero
  const watchLabel =
    contextType === "history"
      ? (isRootHome && usedHistorySlides ? "Tonton lagi" : "Tonton")
      : "Tonton";

  // Kalau nggak ada slide sama sekali â†’ matikan carousel
  if (!slides.length) {
    heroCarousel.classList.add("is-hidden");
    clearCarouselTimers();
    heroSlideCount = 0;
    currentSlideIndex = 0;
    return;
  }

  let slidesHTML = "";
  let indicatorsHTML = `<div class="hero-indicators">`;

  slides.forEach((vid, index) => {
    const activeClass = index === 0 ? " active" : "";
    const year = vid.date ? new Date(vid.date).getFullYear() : "";

    let metaLine = `${vid.category} â€¢ ${vid.duration}`;
    let titleText = vid.title;
    let descText = vid.description || "";

    if (contextType === "folder-label" || contextType === "folder-artist") {
      metaLine = `${folderKind} â€¢ ${totalFolderVideos} video â€¢ ${year}`;
      titleText = `${folderKind}: ${folderName}`;
      descText = vid.description
        ? `Video unggulan: ${vid.title} â€” ${vid.description}`
        : `Koleksi video ${folderKind.toLowerCase()} ${folderName}.`;
    } else {
      metaLine = `${vid.category} â€¢ ${vid.duration} â€¢ ${year}`;
    }

    const safeName = (folderName || "").replace(/'/g, "\\'");

    let secondaryBtn = `
      <button class="hero-btn hero-btn-pink-outline" onclick="goToPlaylistFromCarousel()">
        ğŸ“ Playlist
      </button>
    `;

    if (contextType === "folder-label") {
      secondaryBtn = `
        <button class="hero-btn hero-btn-pink-outline" onclick="shuffleFolder('label','${safeName}')">
          ğŸ”€ Putar Random ${folderKind.toLowerCase()}
        </button>
      `;
    } else if (contextType === "folder-artist") {
      secondaryBtn = `
        <button class="hero-btn hero-btn-pink-outline" onclick="shuffleFolder('artist','${safeName}')">
          ğŸ”€ Putar Random ${folderKind.toLowerCase()}
        </button>
      `;
    }

    slidesHTML += `
      <div class="hero-slide${activeClass}" data-index="${index}" data-video-id="${vid.id}">
        <img src="${vid.thumb}" class="hero-bg-img" alt="${vid.title}">
        <div class="hero-overlay-gradient"></div>

        <div class="hero-content">
          <div class="hero-meta">
            <span>${metaLine}</span>
          </div>

          <h2 class="hero-title">${titleText}</h2>
          <div class="hero-desc">${descText}</div>

          <div class="hero-actions">
            <button class="hero-btn hero-btn-primary" onclick="openPlayerInline(${vid.id})">
              â–¶ ${watchLabel}
            </button>
            ${secondaryBtn}
          </div>
        </div>
      </div>
    `;

    indicatorsHTML += `
      <div class="hero-dot${activeClass}" onclick="userSwitchSlide(${index})"></div>
    `;
  });

  indicatorsHTML += `</div>`;
  heroCarousel.innerHTML = slidesHTML + indicatorsHTML;
  heroCarousel.classList.remove("is-hidden");

  // ğŸ”¥ update state global carousel
  slideDomElements = heroCarousel.querySelectorAll(".hero-slide");
  heroSlideCount = slideDomElements.length;
  currentSlideIndex = 0;

  startCarouselInterval(heroSlideCount);
}


    function goToPlaylistFromCarousel() {
      if (playerSection.classList.contains("show")) {
        closePlayerInline();
      }

      state.mode = "playlist";
      state.category = "Semua";
      state.subFilter = null;
      state.page = 1;

      renderFilters();
      renderGrid();
      checkCarouselVisibility();
    }

    function checkCarouselVisibility() {
      const isPlayerOpen = playerSection.classList.contains("show");
      const isSearchFocused = document.activeElement === searchInput;
      const hasHistory = getHistory().length > 0;

     const isRootHome =
  state.mode === "all" &&
  state.category === "Semua" &&
  !state.subFilter;

// ğŸ”¥ Folder label/artis bisa di semua mode
const isFolderLabel =
  state.category === "Cinematic" &&
  state.subFilter &&
  state.subFilter.type === "label";

const isFolderArtist =
  state.category === "Relax" &&
  state.subFilter &&
  state.subFilter.type === "artist";


      let hasFolderVideos = false;
      if (isFolderLabel || isFolderArtist) {
        const baseList = getModeBaseList();
        const target = (state.subFilter.value || "").toLowerCase();
        const folderVideos = baseList.filter(v =>
          isFolderLabel
            ? (v.label || "").toLowerCase() === target
            : (v.actress || "").toLowerCase() === target
        );
        hasFolderVideos = folderVideos.length > 0;
      }

      if (isSearchFocused) {
        heroCarousel.classList.add("is-hidden");
        return;
      }

   if (
    !isPlayerOpen &&
    (
      // ğŸ”¥ Beranda: SELALU boleh tampil (history ada / tidak),
      // karena sekarang renderCarousel sudah punya fallback 3 video terbaru
      isRootHome ||
      // ğŸ“‚ Folder label / artis: tetap butuh video di folder tsb
      ((isFolderLabel || isFolderArtist) && hasFolderVideos)
    )
  ) {
    heroCarousel.classList.remove("is-hidden");
  } else {
    heroCarousel.classList.add("is-hidden");
  }

    }

function startCarouselInterval(count) {
  clearCarouselTimers();
  if (count <= 1) return;

  carouselInterval = setInterval(() => {
    if (heroSlideCount <= 1) return;
    const nextIndex = (currentSlideIndex + 1) % heroSlideCount; // ğŸ” loop
    switchSlide(nextIndex, "next");
  }, 7000);
}


    // switch slide (dipakai auto & user)
 function switchSlide(targetIndex, direction = null) {
  const slides = slideDomElements;
  const dots = document.querySelectorAll(".hero-dot");

  if (!slides || !slides.length) return;
  
  // Handle Loop Index
  if (targetIndex < 0) targetIndex = slides.length - 1;
  if (targetIndex >= slides.length) targetIndex = 0;

  const currentIndex = currentSlideIndex;
  if (targetIndex === currentIndex) return;

  const currentSlide = slides[currentIndex];
  const nextSlide = slides[targetIndex];

  // 1ï¸âƒ£ Tentukan Arah (PENTING)
  if (!direction) {
    // Kalau index target lebih besar, anggap NEXT. 
    // KECUALI kalau dari Akhir ke Awal (Looping), tetap anggap NEXT biar flow-nya nyambung ke kanan.
    if (currentIndex === slides.length - 1 && targetIndex === 0) {
      direction = "next";
    } 
    // Kalau dari Awal ke Akhir (Mundur), anggap PREV
    else if (currentIndex === 0 && targetIndex === slides.length - 1) {
      direction = "prev";
    } 
    else {
      direction = targetIndex > currentIndex ? "next" : "prev";
    }
  }

  // 2ï¸âƒ£ Reset semua slide lain yang gak terlibat biar bersih
  slides.forEach((s, i) => {
    if (i !== currentIndex && i !== targetIndex) {
      s.className = "hero-slide"; // Balikin ke standby kanan
    }
  });

  // 3ï¸âƒ£ LOGIKA PERGERAKAN
  if (direction === "next") {
    // === GERAK MAJU (Geser ke Kiri) ===
    
    // Slide BARU: Pastikan dia start dari KANAN (default)
    // Kita reset class-nya biar yakin dia di posisi 100% tanpa animasi aneh
    nextSlide.className = "hero-slide from-right"; 
    void nextSlide.offsetWidth; // Force Reflow (Penting!)
    
    // Jalankan Animasi
    nextSlide.className = "hero-slide active"; // Masuk ke tengah
    currentSlide.className = "hero-slide exit-left"; // Slide lama buang ke kiri
    
  } else {
    // === GERAK MUNDUR (Geser ke Kanan) ===
    
    // Slide BARU: Harus teleport dulu ke KIRI (-100%)
    nextSlide.className = "hero-slide from-left";
    void nextSlide.offsetWidth; // Force Reflow (Penting!)
    
    // Jalankan Animasi
    nextSlide.className = "hero-slide active"; // Masuk ke tengah
    // Slide lama biarkan kembali ke posisi default (100% / Kanan)
    // Karena default CSS .hero-slide itu translateX(100%), jadi cukup hapus 'active'
    currentSlide.className = "hero-slide"; 
  }

  // 4ï¸âƒ£ Update Dots
  dots.forEach((dot, i) => {
    dot.classList.toggle("active", i === targetIndex);
  });

  currentSlideIndex = targetIndex;
}
function userSwitchSlide(targetIndex) {
  switchSlide(targetIndex);
  pauseAutoCarousel(); // tetap tunda auto kalau user interaksi
}



    // ====== SWIPE GESTURE HERO CAROUSEL ======
    let touchStartX = 0;
    let touchEndX = 0;
    let isTouchingCarousel = false;

function handleCarouselTouchStart(e) {
  if (!heroCarousel) return;
  isTouchingCarousel = true;
  const point = e.touches ? e.touches[0] : e;
  touchStartX = point.clientX;
  touchEndX = point.clientX;
  clearCarouselTimers(); // stop auto saat user sentuh
}

function handleCarouselTouchMove(e) {
  if (!isTouchingCarousel) return;
  const point = e.touches ? e.touches[0] : e;
  touchEndX = point.clientX;
}

function handleCarouselTouchEnd() {
  if (!isTouchingCarousel) return;
  const deltaX = touchEndX - touchStartX;
  const threshold = 40;

  if (Math.abs(deltaX) > threshold && heroSlideCount > 1) {
    if (deltaX < 0) {
      // swipe kiri â†’ NEXT
      let nextIndex = currentSlideIndex + 1;
      if (nextIndex >= heroSlideCount) nextIndex = 0; // loop ke awal
      switchSlide(nextIndex, "next");
    } else {
      // swipe kanan â†’ PREV
      let prevIndex = currentSlideIndex - 1;
      if (prevIndex < 0) prevIndex = heroSlideCount - 1; // loop ke akhir
      switchSlide(prevIndex, "prev");
    }
    pauseAutoCarousel();
  } else {
    startCarouselInterval(heroSlideCount);
  }

  isTouchingCarousel = false;
  touchStartX = 0;
  touchEndX = 0;
}



if (heroCarousel) {
  heroCarousel.addEventListener("touchstart", handleCarouselTouchStart, { passive: true });
  heroCarousel.addEventListener("touchmove", handleCarouselTouchMove, { passive: true });
  heroCarousel.addEventListener("touchend", handleCarouselTouchEnd);
}


    function renderFilters() {
      filtersEl.innerHTML = "";

      const mainCategories = categories;

      mainCategories.forEach((cat) => {
        const chip = document.createElement("button");
        chip.className =
          "filter-chip" + (state.category === cat ? " active" : "");

        const isAllChip = cat === "Semua";
        let label;

        if (isAllChip) {
          if (state.mode === "playlist") {
            label = "Playlist";
          } else if (state.mode === "history") {
            label = "History";
          } else {
            label = "Semua";
          }
        } else {
          label = categoryLabelMap[cat] || cat;
        }

        chip.textContent = label;

        chip.addEventListener("click", () => {
          if (cat === "Semua") {
            if (state.mode === "all") {
              goHome();
            }
            return;
          }

          state.category = cat;
          state.subFilter = null;
          state.page = 1;
          renderFilters();
          renderGrid();
        });

        filtersEl.appendChild(chip);
      });

      if (
        state.subFilter &&
        (state.subFilter.type === "label" || state.subFilter.type === "artist")
      ) {
        const subChip = document.createElement("button");
        subChip.className = "filter-chip active";
        subChip.type = "button";

        const typeLabel = state.subFilter.type === "label" ? "Label" : "Artis";

        const textSpan = document.createElement("span");
        textSpan.textContent = `${typeLabel}: ${state.subFilter.value}`;

        const closeSpan = document.createElement("span");
        closeSpan.className = "chip-close";
        closeSpan.textContent = "âœ•";

        subChip.appendChild(textSpan);
        subChip.appendChild(closeSpan);

        subChip.addEventListener("click", () => {
          const returnId = lastHashtagSourceId;

          state.subFilter = null;
          state.page = 1;
          lastHashtagSourceId = null;

          renderFilters();
          renderGrid();

          if (returnId) {
            openPlayerInline(returnId);
          }
        });

        filtersEl.appendChild(subChip);
      }

      let labelText = categoryLabelMap[state.category] || state.category;
      if (state.mode === "all" && state.subFilter) {
        if (state.category === "Cinematic" && state.subFilter.type === "label") {
          labelText = `Label â€¢ ${state.subFilter.value}`;
        } else if (state.category === "Relax" && state.subFilter.type === "artist") {
          labelText = `Artis â€¢ ${state.subFilter.value}`;
        }
      }
      activeFilterLabelEl.textContent = labelText;
    }

    function matchesSearch(video, search) {
      if (!search) return true;
      const s = search.toLowerCase();
      const mappedCategory = categoryLabelMap[video.category] || "";
      return (
        video.title.toLowerCase().includes(s) ||
        video.category.toLowerCase().includes(s) ||
        mappedCategory.toLowerCase().includes(s) ||
        (video.label && video.label.toLowerCase().includes(s)) ||
        (video.actress && video.actress.toLowerCase().includes(s)) ||
        (video.kode && video.kode.toLowerCase().includes(s))
      );
    }

    function matchesCategory(video, category) {
      if (category === "Semua") return true;

      if (category === "Cinematic") {
        if (state.mode === "all") return true;
        return video.category === "Cinematic";
      }

      if (category === "Relax") {
        if (state.mode === "all") return true;
        return video.category === "Relax";
      }

      return true;
    }

    function getPlaylist() {
      return loadFromStorage(STORAGE_KEYS.PLAYLIST, []);
    }

    function savePlaylist(arr) {
      saveToStorage(STORAGE_KEYS.PLAYLIST, arr);
    }

    function getHistory() {
      return loadFromStorage(STORAGE_KEYS.HISTORY, []);
    }

    function saveHistory(arr) {
      saveToStorage(STORAGE_KEYS.HISTORY, arr);
    }

    function getModeBaseList() {
      let list = videos.slice();
      if (state.mode === "playlist") {
        const pl = getPlaylist();
        list = list.filter(v => pl.includes(v.id));
      } else if (state.mode === "history") {
        const hist = getHistory();
        list = list.filter(v => hist.includes(v.id));
      }
      return list;
    }

    function getFilteredSortedVideos() {
      const search = state.search;
      const cat = state.category;
      const playerOpen = playerSection && playerSection.classList.contains("show");

      let list = getModeBaseList();

      let currentVideo = null;
      if (playerOpen && playerSection.dataset.currentId) {
        const currentId = parseInt(playerSection.dataset.currentId, 10);
        currentVideo = videos.find(v => v.id === currentId) || null;
      }

      list = list.filter(
        (v) =>
          matchesCategory(v, cat) &&
          (playerOpen ? true : matchesSearch(v, search))
      );

      if (state.mode === "all" && state.category === "Cinematic" && state.subFilter && state.subFilter.type === "label") {
        const target = state.subFilter.value.toLowerCase();
        list = list.filter(v => (v.label || "").toLowerCase() === target);
      }

      if (state.mode === "all" && state.category === "Relax" && state.subFilter && state.subFilter.type === "artist") {
        const target = state.subFilter.value.toLowerCase();
        list = list.filter(v => (v.actress || "").toLowerCase() === target);
      }

      if (playerOpen && currentVideo && state.mode === "all") {
        const currentLabel = (currentVideo.label || "").toLowerCase();
        const currentActress = (currentVideo.actress || "").toLowerCase();

        const related = list.filter(v => {
          if (v.id === currentVideo.id) return false;
          const sameLabel =
            currentLabel && (v.label || "").toLowerCase() === currentLabel;
          const sameActress =
            currentActress && (v.actress || "").toLowerCase() === currentActress;
          return sameLabel || sameActress;
        });

        if (related.length > 0) {
          list = related;
        }
      }

      if (state.mode === "playlist" || state.mode === "history") {
        const orderArr = state.mode === "playlist" ? getPlaylist() : getHistory();
        list.sort((a, b) => orderArr.indexOf(a.id) - orderArr.indexOf(b.id));
      } else {
        switch (state.sort) {
          case "newest":
            list.sort((a, b) => parseDate(b.date) - parseDate(a.date));
            break;
          case "oldest":
            list.sort((a, b) => parseDate(a.date) - parseDate(b.date));
            break;
          case "shortest":
            list.sort((a, b) => a.durationSec - b.durationSec);
            break;
          case "longest":
            list.sort((a, b) => b.durationSec - a.durationSec);
            break;
        }
      }

      return list;
    }

    function updateModeButtons() {
      playlistBtn.classList.toggle("active", state.mode === "playlist");
      historyBtn.classList.toggle("active", state.mode === "history");

      if (state.mode === "playlist") {
        modeLabelEl.textContent = "Playlist";
      } else if (state.mode === "history") {
        modeLabelEl.textContent = "History";
      } else {
        modeLabelEl.textContent = "Semua video";
      }
    }

    function setSort(value) {
      state.sort = value;
      const label = value === "newest" ? "Terbaru" : "Terlama";
      sortTriggerLabel.textContent = label;

      [...sortMenu.querySelectorAll("button")].forEach(btn => {
        btn.classList.toggle("active", btn.dataset.value === value);
      });

      closeSortMenu();
      state.page = 1;
      renderGrid();
    }

    function openSortMenu() {
      sortMenu.classList.add("show");
    }

    function closeSortMenu() {
      sortMenu.classList.remove("show");
    }

    sortTrigger.addEventListener("click", (e) => {
      e.stopPropagation();
      const isOpen = sortMenu.classList.contains("show");
      if (isOpen) closeSortMenu();
      else openSortMenu();
    });

    sortMenu.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-value]");
      if (!btn) return;
      setSort(btn.dataset.value);
    });

    document.addEventListener("click", (e) => {
      if (!sortWrapper.contains(e.target)) {
        closeSortMenu();
      }
    });
document.addEventListener("click", (e) => {
  // existing logic sort
  if (!sortWrapper.contains(e.target)) {
    closeSortMenu();
  }

  // tutup suggestion kalau klik di luar search box
  if (searchBoxWrap && !searchBoxWrap.contains(e.target)) {
    hideSearchSuggestions();
  }
});

if (searchInput) {
  searchInput.addEventListener("blur", () => {
    // kasih sedikit delay biar klik di suggestion masih kebaca
    setTimeout(() => {
      if (!document.activeElement || document.activeElement !== searchInput) {
        hideSearchSuggestions();
      }
    }, 150);
  });
}

    function closePlayerInline() {
      playerSection.classList.remove("show");
      playerSection.classList.remove("wide");
      playerSection.classList.remove("cinema");
      body.classList.remove("cinema-mode");

      playerVideoEl.pause();
      playerDriveWrap.style.display = "none";
      playerDriveWrap.innerHTML = "";
      delete playerSection.dataset.currentId;
      delete playerSection.dataset.mode;

      playerHistoryStack = [];
      updateBackButton();

      if (filtersEl) filtersEl.style.display = "flex";
      if (filterInfoEl) filterInfoEl.style.display = "block";
      if (videoInfoEl) videoInfoEl.style.display = "block";
      if (otherVideosHeader) otherVideosHeader.style.display = "none";

      if (searchBoxWrap) searchBoxWrap.style.display = "flex";
      if (sortWrapper) sortWrapper.style.display = "inline-flex";
  
      checkCarouselVisibility();
      renderGrid();
    }

    function togglePlaylistMode() {
      if (playerSection.classList.contains("show")) {
        closePlayerInline();
      }

      if (state.mode === "playlist") {
        state.mode = "all";
      } else {
        state.mode = "playlist";
        state.category = "Semua";
        state.subFilter = null;
      }
      state.page = 1;
      
      checkCarouselVisibility();
      renderFilters();
      renderGrid();
    }

    function toggleHistoryMode() {
      if (playerSection.classList.contains("show")) {
        closePlayerInline();
      }

      if (state.mode === "history") {
        state.mode = "all";
      } else {
        state.mode = "history";
        state.category = "Semua";
        state.subFilter = null;
      }
      state.page = 1;

      checkCarouselVisibility();
      renderFilters();
      renderGrid();
    }

    function goHome() {
      if (playerSection.classList.contains("show")) {
        closePlayerInline();
      }

      state.mode = "all";
      state.category = "Semua";
      state.subFilter = null;
      state.page = 1;

      renderFilters();
      renderGrid();
      checkCarouselVisibility();

      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    playlistBtn.addEventListener("click", togglePlaylistMode);
    historyBtn.addEventListener("click", toggleHistoryMode);
    homeBtn.addEventListener("click", goHome);

    function togglePlaylist(videoId) {
      const pl = getPlaylist();
      const idx = pl.indexOf(videoId);
      let message = "";
      if (idx >= 0) {
        pl.splice(idx, 1);
        message = "Video dihapus dari playlist";
      } else {
        pl.push(videoId);
        message = "Video ditambahkan ke playlist";
      }
      savePlaylist(pl);
      updatePlayerPlaylistButton(videoId);
      renderGrid();
      showToast(message);
    }

    function goToPlaylistFolder(videoId) {
      if (typeof videoId === "number") {
        let pl = getPlaylist();
        if (!pl.includes(videoId)) {
          pl.push(videoId);
          savePlaylist(pl);
          showToast("Video ditambahkan ke playlist");
        }
      }

      state.mode = "playlist";
      state.category = "Semua";
      state.subFilter = null;
      state.page = 1;

      if (playerSection.classList.contains("show")) {
        closePlayerInline();
      } else {
        checkCarouselVisibility();
        renderFilters();
        renderGrid();
      }
    }

    function updatePlayerPlaylistButton(videoId) {
      const pl = getPlaylist();
      const inPlaylist = pl.includes(videoId);
      if (!playerPlaylistMainBtn) return;

      playerPlaylistMainBtn.classList.toggle("active", inPlaylist);

      if (inPlaylist) {
        playerPlaylistMainBtn.innerHTML = `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor" d="M6 3h12v18l-6-4-6 4z"></path>
          </svg>
          <span>Hapus dari Playlist</span>
        `;
        playerPlaylistMainBtn.setAttribute("title", "Hapus dari playlist");
      } else {
        playerPlaylistMainBtn.innerHTML = `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path fill="currentColor" d="M6 3h12v18l-6-4-6 4z"></path>
          </svg>
          <span>Tambah ke Playlist</span>
        `;
        playerPlaylistMainBtn.setAttribute("title", "Tambah ke playlist");
      }
    }

    function addToHistory(videoId) {
      let hist = getHistory();
      hist = hist.filter((id) => id !== videoId);
      hist.unshift(videoId);
      if (hist.length > 50) hist = hist.slice(0, 50);
      saveHistory(hist);
      renderCarousel();
    }

    function renderLabelSelection() {
      const baseList = getModeBaseList();
      const labels = uniqueValues(baseList.map(v => v.label));
      const search = state.search.toLowerCase();

      const filteredLabels = labels.filter(name =>
        name && (!search || name.toLowerCase().includes(search))
      );

      gridEl.innerHTML = "";
      emptyEl.style.display = "none";
      paginationWrapEl.style.display = "none";

      countTextEl.textContent = filteredLabels.length;

      if (countSuffixEl) {
        countSuffixEl.textContent = " folder di label";
      }

      if (filteredLabels.length === 0) {
        emptyEl.innerHTML = "Tidak ada label yang cocok dengan pencarian.";
        emptyEl.style.display = "block";
        return;
      }

      filteredLabels.forEach((name) => {
        const videosForLabel = baseList.filter(v => v.label === name);
        const sample = videosForLabel[0];

        const card = document.createElement("div");
        card.className = "card";

        card.innerHTML = `
          <div class="thumb-wrapper">
            <img class="thumb" src="${sample ? sample.thumb : ""}" alt="${name}" />
            <div class="thumb-overlay">
              <div class="play-pill">
                <div class="play-icon">ğŸ“</div>
                <span>Label</span>
              </div>
            </div>
          </div>
          <div class="card-main">
            <div class="card-title">${name}</div>
            <div class="card-meta">
              <span>${videosForLabel.length} video</span>
            </div>
          </div>
        `;

        card.addEventListener("click", () => {
          state.subFilter = { type: "label", value: name };
          state.page = 1;
          renderFilters();
          renderGrid();
        });

        gridEl.appendChild(card);
      });

      gridEl.classList.remove("list-view");
      renderCarousel();
      checkCarouselVisibility();
    }

    function renderArtistSelection() {
      const baseList = getModeBaseList();
      const artists = uniqueValues(baseList.map(v => v.actress));
      const search = state.search.toLowerCase();

      const filteredArtists = artists.filter(name =>
        name && (!search || name.toLowerCase().includes(search))
      );

      gridEl.innerHTML = "";
      emptyEl.style.display = "none";
      paginationWrapEl.style.display = "none";

      countTextEl.textContent = filteredArtists.length;

      if (countSuffixEl) {
        countSuffixEl.textContent = " folder di artis";
      }

      if (filteredArtists.length === 0) {
        emptyEl.innerHTML = "Tidak ada artis yang cocok dengan pencarian.";
        emptyEl.style.display = "block";
        return;
      }

      filteredArtists.forEach((name) => {
        const videosForArtist = baseList.filter(v => v.actress === name);
        const sample = videosForArtist[0];

        const card = document.createElement("div");
        card.className = "card";

        card.innerHTML = `
          <div class="thumb-wrapper">
            <img class="thumb" src="${sample ? sample.thumb : ""}" alt="${name}" />
            <div class="thumb-overlay">
              <div class="play-pill">
                <div class="play-icon">ğŸ“</div>
                <span>Artis</span>
              </div>
            </div>
          </div>
          <div class="card-main">
            <div class="card-title">${name}</div>
            <div class="card-meta">
              <span>${videosForArtist.length} video</span>
            </div>
          </div>
        `;

        card.addEventListener("click", () => {
          state.subFilter = { type: "artist", value: name };
          state.page = 1;
          renderFilters();
          renderGrid();
        });

        gridEl.appendChild(card);
      });

      gridEl.classList.remove("list-view");
      renderCarousel();
      checkCarouselVisibility();
    }

    function renderPagination(totalItems) {
      const perPage = state.perPage;
      const totalPages = Math.ceil(totalItems / perPage);

      if (totalPages <= 1) {
        paginationWrapEl.style.display = "none";
        paginationEl.innerHTML = "";
        return;
      }

      if (state.page > totalPages) {
        state.page = totalPages;
      }
      if (state.page < 1) state.page = 1;

      paginationWrapEl.style.display = "block";
      paginationEl.innerHTML = "";

      const createBtn = (label, page, disabled = false, isActive = false) => {
        const btn = document.createElement("button");
        btn.className = "page-btn" + (isActive ? " active" : "");
        btn.textContent = label;
        if (disabled) {
          btn.disabled = true;
        } else {
          btn.addEventListener("click", () => {
            state.page = page;
            renderGrid();
            window.scrollTo({ top: playerSection.classList.contains("show") ? playerSection.offsetTop : 0, behavior: "smooth" });
          });
        }
        return btn;
      };

      paginationEl.appendChild(
        createBtn("Â«", state.page - 1, state.page === 1, false)
      );

      for (let i = 1; i <= totalPages; i++) {
        paginationEl.appendChild(
          createBtn(i, i, false, i === state.page)
        );
      }

      paginationEl.appendChild(
        createBtn("Â»", state.page + 1, state.page === totalPages, false)
      );
    }

    function renderGrid() {
      updateModeButtons();
updateSearchPlaceholder();
      if (state.category === "Cinematic" && !state.subFilter) {
        renderLabelSelection();
        return;
      }

      if (state.category === "Relax" && !state.subFilter) {
        renderArtistSelection();
        return;
      }

      const baseList = getModeBaseList();
      const list = getFilteredSortedVideos();

      gridEl.innerHTML = "";
      countTextEl.textContent = list.length;

      if (countSuffixEl) {
        let suffix = " video";

        if (state.subFilter && state.mode === "all") {
          if (state.subFilter.type === "label") {
            suffix += ` di label ${state.subFilter.value}`;
          } else if (state.subFilter.type === "artist") {
            suffix += ` di artis ${state.subFilter.value}`;
          }
        } else if (state.mode === "playlist") {
          suffix += " di Playlist";
        } else if (state.mode === "history") {
          suffix += " di History";
        }

        countSuffixEl.textContent = suffix;
      }

      if (baseList.length === 0) {
        let msg = "Tidak ada video untuk mode ini.";
        if (state.mode === "playlist") {
          msg = "Playlist kamu masih kosong. Buka video lalu klik tombol Playlist di player untuk menambahkannya.";
        } else if (state.mode === "history") {
          msg = "Belum ada riwayat tontonan. Coba buka salah satu video dulu.";
        }
        emptyEl.innerHTML = msg;
        emptyEl.style.display = "block";
        paginationWrapEl.style.display = "none";
        renderCarousel();
        checkCarouselVisibility();
        return;
      }

      if (list.length === 0) {
        emptyEl.innerHTML = `
          Tidak ada video yang cocok dengan pencarian / filter kamu di mode
          <strong>${state.mode === "playlist" ? "Playlist" : state.mode === "history" ? "History" : "Semua"}</strong>.<br/>
          Coba atur ulang filter atau hapus kata kunci ya. ğŸ™‚
        `;
        emptyEl.style.display = "block";
        paginationWrapEl.style.display = "none";
        renderCarousel();
        checkCarouselVisibility();
        return;
      } else {
        emptyEl.style.display = "none";
      }

      renderPagination(list.length);

      const perPage = state.perPage;
      const totalPages = Math.ceil(list.length / perPage);
      if (state.page > totalPages) state.page = totalPages || 1;

      const startIndex = (state.page - 1) * perPage;
      const endIndex = startIndex + perPage;
      const pageItems = list.slice(startIndex, endIndex);

      const itemsPerRow = 5;

      pageItems.forEach((video, index) => {
        const catKind = categoryLabelMap[video.category] || video.category;
        let metaText = catKind;
        if (catKind === "Label") {
          metaText = video.label || "Label";
        } else if (catKind === "Artis") {
          metaText = video.actress || "Artis";
        }

        const card = document.createElement("div");
        card.className = "card";
        card.dataset.id = video.id;

        card.innerHTML = `
          <div class="thumb-wrapper">
            <img class="thumb" src="${video.thumb}" alt="${video.title}" />
            <div class="thumb-overlay">
              <div class="play-pill">
                <div class="play-icon">â–¶</div>
                <span>Tonton</span>
              </div>
            </div>
          </div>
          <div class="card-main">
            <div class="card-title">${video.title}</div>
            <div class="card-meta">
              <span>${metaText}</span>
            </div>
          </div>
        `;

        card.addEventListener("click", () => {
          openPlayerInline(video.id);
        });

        gridEl.appendChild(card);

        if ((index + 1) % itemsPerRow === 0 && index !== pageItems.length - 1) {
          const sep = document.createElement("div");
          sep.className = "grid-separator";
          sep.innerHTML = `
            <span class="grid-separator-line"></span>
            <span class="grid-separator-line"></span>
          `;
          gridEl.appendChild(sep);
        }
      });

      gridEl.classList.remove("list-view");

      // ğŸ”¥ update carousel sesuai context (home / folder label / folder artis)
      renderCarousel();
      checkCarouselVisibility();
    }

searchInput.addEventListener("input", (e) => {
  const value = e.target.value;
  const trimmed = value.trim();

  // ğŸ”¥ Tampilkan/ sembunyikan tombol X
  if (searchClearBtn) {
    searchClearBtn.style.display = trimmed ? "inline-flex" : "none";
  }

  // Hapus suggestion timer lama
  clearTimeout(searchSuggestTimer);

  // Kalau input kosong â†’ reset pencarian & grid
  if (!trimmed) {
    state.search = "";
    state.page = 1;

    hideSearchSuggestions();
    hideGridShimmer();
    renderGrid();   // balik ke kondisi awal sesuai mode (home/playlist/history/folder)
    return;         // stop, jangan proses suggestion
  }

  // ===== Hanya untuk suggestion (debounce) =====
  searchSuggestTimer = setTimeout(() => {
    updateSearchSuggestions(value);
  }, 700); // ini nanti bisa kamu atur durasinya (lihat poin 3)
});

searchInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();

    // ğŸ”¥ stop rencana suggestion yang masih pending
    clearTimeout(searchSuggestTimer);
    searchSuggestTimer = null;

    // Tutup suggestion yang mungkin lagi kebuka
    hideSearchSuggestions();

    const value = searchInput.value.trim();

    // Tampilkan shimmer (opsional)
    showGridShimmer();

    // Update state
    state.search = value;
    state.page = 1;

    // Render hasil
    setTimeout(() => {
      renderGrid();
      hideGridShimmer();
    }, 1000);
  }
});







if (searchInput) {
  searchInput.addEventListener("keydown", (e) => {
    if (!searchSuggestionsEl || searchSuggestionsEl.style.display === "none") return;

    const list = searchSuggestionsEl._currentList || [];
    if (!list.length) return;

    if (e.key === "ArrowDown") {
      e.preventDefault();
      suggestionActiveIndex = (suggestionActiveIndex + 1) % list.length;
    } else if (e.key === "ArrowUp") {
      e.preventDefault();
      suggestionActiveIndex = (suggestionActiveIndex - 1 + list.length) % list.length;
} else if (e.key === "Enter") {
  if (suggestionActiveIndex >= 0 && suggestionActiveIndex < list.length) {
    e.preventDefault();
    const item = list[suggestionActiveIndex];
    applySuggestionItem(item);   // ğŸ”¥ sama kayak klik mouse
  }
  return;
}


    // update class .active
    const els = searchSuggestionsEl.querySelectorAll(".search-suggestion-item");
    els.forEach((el, idx) => {
      el.classList.toggle("active", idx === suggestionActiveIndex);
    });
  });
}


    function updateWideButton() {
      const mode = playerSection.dataset.mode || "normal";
      if (mode === "normal") {
        playerWideBtn.title = "Perbesar tampilan";
      } else if (mode === "wide") {
        playerWideBtn.title = "Mode gelap (video saja)";
      } else if (mode === "cinema") {
        playerWideBtn.title = "Kembalikan ke tampilan awal";
      }
    }
function updateBackButton() {
  if (!playerBackBtn) return;
  // selalu tampil, biar setiap preview video ada tombol back
  playerBackBtn.style.display = "inline-flex";
}


    function setPlayerMode(mode) {
      playerSection.classList.remove("wide", "cinema");
      body.classList.remove("cinema-mode");

      if (mode === "wide") {
        playerSection.classList.add("wide");
      } else if (mode === "cinema") {
        playerSection.classList.add("wide");
        playerSection.classList.add("cinema");
        body.classList.add("cinema-mode");
      }
      playerSection.dataset.mode = mode;
      updateWideButton();
    }

    playerWideBtn.addEventListener("click", () => {
      if (!playerSection.classList.contains("show")) return;
      const current = playerSection.dataset.mode || "normal";
      let next;
      if (current === "normal") {
        next = "wide";
      } else if (current === "wide") {
        next = "cinema";
      } else {
        next = "normal";
      }
      setPlayerMode(next);
    });

    function openPlayerInline(id) {
      const video = videos.find((v) => v.id === id);
      if (!video) return;

      const currentIdExisting = parseInt(playerSection.dataset.currentId || "-1", 10);
      if (!isNavigatingBack && currentIdExisting > 0 && currentIdExisting !== id) {
        playerHistoryStack.push(currentIdExisting);
      }

      playerSection.dataset.currentId = id;
      playerTitleEl.textContent = video.title;

      const catLabel = categoryLabelMap[video.category] || video.category;
      playerCategoryEl.textContent = catLabel || "-";
      playerDateEl.textContent = video.date || "-";
      playerDescEl.textContent = video.description || "";
      playerCodeEl.textContent = video.kode || "-";
      playerStudioEl.textContent = video.studio || "-";
      playerLabelEl.textContent = video.label || "-";
      playerActorEl.textContent = video.actor || "-";
      playerActressEl.textContent = video.actress || "-";

      if (playerLabelBtn) {
        if (video.label) {
          playerLabelBtn.textContent = `#${video.label}`;
          playerLabelBtn.style.display = "inline-flex";
        } else {
          playerLabelBtn.style.display = "none";
        }
      }

      if (playerArtistBtn) {
        if (video.actress) {
          playerArtistBtn.textContent = `#${video.actress}`;
          playerArtistBtn.style.display = "inline-flex";
        } else {
          playerArtistBtn.style.display = "none";
        }
      }

      playerSizeEl.textContent = video.size ? video.size : "";
      let downloadUrl = video.downloadUrl || video.src || "";

      playerSection.dataset.currentId = id;
      playerSection.classList.add("show");
      playerSection.classList.remove("wide", "cinema");
      body.classList.remove("cinema-mode");
      playerSection.dataset.mode = "normal";
      updateWideButton();

      if (downloadUrl) {
        playerDownloadEl.href = downloadUrl;
        playerDownloadEl.style.display = "inline-flex";

        const labelText = video.embed
          ? "Download dari Drive"
          : "Download video";

        playerDownloadEl.innerHTML = `
          ${DRIVE_ICON_SVG}
          <span class="download-label">${labelText}</span>
        `;
      } else {
        playerDownloadEl.style.display = "none";
      }

      if (video.embed) {
        playerVideoEl.pause();
        playerVideoEl.style.display = "none";
        playerDriveWrap.style.display = "block";
        playerDriveWrap.innerHTML = `
          <iframe 
            src="${video.embed}" 
            allow="autoplay; encrypted-media" 
            allowfullscreen
            loading="lazy">
          </iframe>
        `;
      } else {
        playerDriveWrap.style.display = "none";
        playerDriveWrap.innerHTML = "";
        playerVideoEl.style.display = "block";
        playerVideoSourceEl.src = video.src;
        playerVideoEl.load();
        playerVideoEl.currentTime = 0;
      }

      updatePlayerPlaylistButton(id);
      addToHistory(id);
      updateBackButton();

      checkCarouselVisibility();
      renderGrid();

      if (filtersEl) filtersEl.style.display = "none";
      if (filterInfoEl) filterInfoEl.style.display = "none";
      if (videoInfoEl) videoInfoEl.style.display = "none";
      if (otherVideosHeader) otherVideosHeader.style.display = "block";

      if (searchBoxWrap) searchBoxWrap.style.display = "none";
      if (sortWrapper) sortWrapper.style.display = "none";

      window.scrollTo({
        top: 0,
        behavior: "smooth"
      });
    }

    playerCloseBtn.addEventListener("click", closePlayerInline);
if (playerBackBtn) {
  playerBackBtn.addEventListener("click", () => {
    // 1ï¸âƒ£ Kalau ada history video â†’ balik ke video sebelumnya
    if (playerHistoryStack.length) {
      const prevId = playerHistoryStack.pop();
      if (!prevId) {
        closePlayerInline();
        return;
      }

      isNavigatingBack = true;
      openPlayerInline(prevId);
      isNavigatingBack = false;

      updateBackButton();
      return;
    }

    // 2ï¸âƒ£ Kalau tidak ada history â†’ anggap "kembali ke halaman sebelumnya"
    //    = tutup player dan balik ke tampilan grid/folder yang tadi
    closePlayerInline();
  });
}


    playerPlaylistMainBtn.addEventListener("click", () => {
      const id = parseInt(playerSection.dataset.currentId || "-1", 10);
      if (!id || id === -1) return;
      togglePlaylist(id);
    });

    playerLabelEl.addEventListener("click", () => {
      const value = playerLabelEl.textContent.trim();
      if (!value || value === "-") return;

      state.mode = "all";
      state.category = "Cinematic";
      state.subFilter = { type: "label", value };
      state.page = 1;

      renderFilters();
      closePlayerInline();
    });

    if (playerLabelBtn) {
      playerLabelBtn.addEventListener("click", () => {
        const value = playerLabelEl.textContent.trim();
        if (!value || value === "-") return;

        const currentId = parseInt(playerSection.dataset.currentId || "-1", 10);
        lastHashtagSourceId = currentId > 0 ? currentId : null;

        state.mode = "all";
        state.category = "Cinematic";
        state.subFilter = { type: "label", value };
        state.page = 1;

        renderFilters();
        closePlayerInline();
      });
    }

    playerActressEl.addEventListener("click", () => {
      const value = playerActressEl.textContent.trim();
      if (!value || value === "-") return;

      state.mode = "all";
      state.category = "Relax";
      state.subFilter = { type: "artist", value };
      state.page = 1;

      renderFilters();
      closePlayerInline();
    });

    if (playerArtistBtn) {
      playerArtistBtn.addEventListener("click", () => {
        const value = playerActressEl.textContent.trim();
        if (!value || value === "-") return;

        const currentId = parseInt(playerSection.dataset.currentId || "-1", 10);
        lastHashtagSourceId = currentId > 0 ? currentId : null;

        state.mode = "all";
        state.category = "Relax";
        state.subFilter = { type: "artist", value };
        state.page = 1;

        renderFilters();
        closePlayerInline();
      });
    }

    document.addEventListener("keydown", (e) => {
      const isOpen = playerSection.classList.contains("show");
      if (!isOpen) return;

      const tag = e.target.tagName.toLowerCase();
      if (tag === "input" || tag === "textarea") return;

      const currentId = parseInt(playerSection.dataset.currentId || "-1", 10);
      const video = videos.find(v => v.id === currentId);

      if (video && !video.embed) {
        if (e.key === " ") {
          e.preventDefault();
          if (playerVideoEl.paused) playerVideoEl.play();
          else playerVideoEl.pause();
        } else if (e.key === "ArrowRight") {
          playerVideoEl.currentTime += 5;
        } else if (e.key === "ArrowLeft") {
          playerVideoEl.currentTime -= 5;
        } else if (e.key === "Escape") {
          closePlayerInline();
        }
      } else {
        if (e.key === "Escape") {
          closePlayerInline();
        }
      }
    });

    document.addEventListener("contextmenu", (e) => {
      e.preventDefault();
    });

 // INIT
applyResponsivePerPage();
buildSearchIndex();        // ğŸ”¥ bikin index suggestion
renderFilters();
updateSearchPlaceholder();
renderGrid();



  </script>
</body>
</html>
